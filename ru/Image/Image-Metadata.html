<!DOCTYPE html>
<html lang="ru-RU">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Бесплатный онлайн-просмотр метаданных изображений | CaliperTools</title>
    <meta name="description" content="Просматривайте метаданные изображений онлайн бесплатно. Мгновенно извлекайте данные EXIF, GPS, информацию о камере. Регистрация не требуется. Лучшие результаты качества.">
    <link rel="icon" type="image/png" sizes="32x32" href="../../images/favicon32.png">
    <link rel="stylesheet" href="../../styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exif-js/2.3.0/exif.min.js"></script>
    <script src="../scripts/script.js"></script>
    <!-- Custom CSS for sections -->
    <style>
        /* Tutorial and Introduction Section Styles */
        .tutorial-section {
            background: linear-gradient(to right, #3b82f6, #8b5cf6);
            color: white;
            padding: 5rem 0;
            margin-top: 5rem;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }

        .text-4xl {
            font-size: 2.5rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 4rem;
        }

        .grid {
            display: grid;
            gap: 2rem;
        }

        .grid-cols-1 {
            grid-template-columns: 1fr;
        }

        @media (min-width: 640px) {
            .sm\:grid-cols-2 {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .lg\:grid-cols-4 {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .tutorial-card {
            background: white;
            color: #1f2937;
            border-radius: 0.75rem;
            padding: 2rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .tutorial-card:hover {
            transform: scale(1.05);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .tutorial-card h3 {
            font-size: 1.5rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .tutorial-icon {
            background: #3b82f6;
            color: white;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            font-size: 1.25rem;
        }

        .tutorial-card p {
            color: #6b7280;
            line-height: 1.5;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            cursor: help;
        }

        /* Feature Section Styles */
        .feature-section {
            padding: 5rem 0;
            background: white;
        }

        .feature-section.gray {
            background: #f9fafb;
        }

        .grid-cols-2 {
            display: grid;
            grid-template-columns: 1fr;
            gap: 4rem;
            align-items: center;
        }

        @media (min-width: 768px) {
            .grid-cols-2 {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .content-image img {
            border-radius: 0.75rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            width: 100%;
        }

        .content-text h2 {
            font-size: 2.25rem;
            font-weight: bold;
            color: #111827;
            margin-bottom: 1.5rem;
        }

        .content-text p {
            font-size: 1.125rem;
            color: #6b7280;
            margin-bottom: 1.5rem;
            line-height: 1.75;
        }

        /* Order Classes */
        .order-2 {
            order: 2;
        }

        .order-1 {
            order: 1;
        }

        @media (min-width: 768px) {
            .md\:order-1 {
                order: 1;
            }
            .md\:order-2 {
                order: 2;
            }
        }

        /* Bottom Text Area */
        .bottom-text-section {
            padding: 5rem 0;
            background: linear-gradient(to bottom, #f9fafb, white);
        }

        .bottom-text-section h2 {
            font-size: 2.25rem;
            font-weight: bold;
            color: #111827;
            margin-bottom: 1.5rem;
        }

        .bottom-text-section p {
            font-size: 1.125rem;
            color: #6b7280;
            margin-bottom: 1.5rem;
            line-height: 1.75;
        }

        .mb-10 {
            margin-bottom: 2.5rem;
        }

        /* Related Tools Section */
        .related-tools {
            padding: 4rem 0;
            background: white;
        }

        .section-title {
            font-size: 2.25rem;
            font-weight: bold;
            color: #111827;
            margin-bottom: 3rem;
            text-align: center;
        }

        /* Text Alignment Classes */
        .text-center {
            text-align: center;
        }
    </style>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
        }

        .metadata-container {
            display: flex;
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            background-color: #fff;
            height: 750px;
        }

        @media (max-width: 768px) {
            .metadata-container {
                flex-direction: column-reverse;
                height: auto;
            }

            .sidebar-container {
                width: 100%;
                border-right: none;
                border-top: 1px solid #ddd;
                border-bottom: none;
            }

            .sidebar {
                height: auto;
                max-height: none;
                padding: 15px;
            }

            .sidebar-content {
                max-height: none;
                overflow-y: visible;
            }

            .sidebar-actions {
                position: relative;
                border-top: 1px solid #ddd;
            }

            .preview-area {
                height: auto;
                min-height: 400px;
                max-height: 60vh;
            }

            .upload-prompt {
                width: calc(100% - 40px);
                height: calc(100% - 40px);
            }

            .sidebar .tools-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
        }

        .sidebar-container {
            width: 380px;
            border-right: 1px solid #ddd;
        }

        .sidebar {
            padding: 20px;
            background-color: #ffffff;
            height: 750px;
            overflow-y: auto;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: #bbb;
            border-radius: 3px;
        }

        .sidebar::-webkit-scrollbar-thumb:hover {
            background: #999;
        }

        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .upload-section {
            margin-bottom: 20px;
        }

        .upload-btn {
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            width: 100%;
        }

        .upload-btn:hover {
            background-color: #0056b3;
        }

        .file-input {
            display: none;
        }

        .tools-section {
            margin-bottom: 20px;
        }

        .tools-section h2 {
            font-size: 16px;
            margin-bottom: 15px;
            color: #0F172A;
        }

        .sidebar .tools-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .tool-btn {
            padding: 10px 5px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            text-align: center;
        }

        .tool-btn:hover {
            border-color: #007bff;
            background-color: rgba(0, 123, 255, 0.05);
        }

        .tool-btn.active {
            background-color: #007bff;
            color: white;
            border-color: #007bff;
        }

        .tool-btn i {
            font-size: 18px;
            margin-bottom: 5px;
        }

        .tool-btn span {
            font-size: 11px;
        }

        .privacy-statement {
            margin-top: 20px;
            padding: 15px;
            background-color: #f0f9ff;
            border-left: 4px solid #3b82f6;
            border-radius: 4px;
            font-size: 14px;
            color: #1e40af;
        }

        .preview-area {
            flex: 1;
            padding: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: #ffffff;
            position: relative;
        }

        .upload-prompt {
            text-align: center;
            padding: 0;
            border: none;
            border-radius: 0;
            transition: all 0.3s ease;
            width: calc(100% - 80px);
            height: calc(100% - 80px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 2px dashed #ccc;
            border-radius: 8px;
        }

        .upload-prompt.drag-over {
            border-color: #007bff;
            background-color: rgba(0, 123, 255, 0.05);
        }

        .upload-prompt-icon {
            font-size: 60px;
            color: #007bff;
            margin-bottom: 20px;
        }

        .upload-prompt-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #0F172A;
        }

        .upload-prompt-instruction {
            font-size: 16px;
            color: #666;
            margin-bottom: 20px;
        }

        .preview-wrapper {
            position: relative;
            display: none;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            max-width: 100%;
            max-height: 100%;
        }

        .delete-image-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 40px;
            height: 40px;
            background-color: rgba(220, 53, 69, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
            z-index: 100;
        }

        .delete-image-btn:hover {
            background-color: rgba(220, 53, 69, 1);
            transform: scale(1.1);
        }

        .preview-wrapper.active {
            display: block;
        }

        .preview-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .result-panel {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 20px;
            overflow-y: auto;
            display: none;
            color: #ffffff;
        }

        .result-panel.active {
            display: block;
        }

        .result-panel h3 {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #ffffff;
        }

        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }

        .result-table th,
        .result-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .result-table th {
            background-color: rgba(255, 255, 255, 0.15);
            font-weight: bold;
            color: #ffffff;
        }

        .result-table td {
            color: #e0e0e0;
        }

        .result-table tr:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .result-info {
            margin-bottom: 15px;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }

        .result-info h4 {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #ffffff;
        }

        .result-info p {
            font-size: 14px;
            color: #e0e0e0;
            margin-bottom: 5px;
        }

        .result-info strong {
            color: #ffffff;
        }

        .result-info ul {
            margin-left: 20px;
            margin-top: 10px;
            color: #e0e0e0;
        }

        .result-info li {
            margin-bottom: 5px;
        }

        .download-section {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .download-btn {
            background-color: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .download-btn:hover {
            background-color: #2563eb;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .download-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .histogram-container {
            width: 100%;
            height: 200px;
            margin-bottom: 15px;
        }

        .color-palette {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }

        .color-swatch {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .color-swatch:hover {
            transform: scale(1.1);
            border-color: rgba(255, 255, 255, 0.6);
        }

        .color-swatch span {
            font-size: 12px;
            color: #ffffff;
            margin-top: 5px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
        }

        .edit-form {
            margin-bottom: 15px;
        }

        .edit-form label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
            color: #ffffff;
        }

        .edit-form input,
        .edit-form textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            margin-bottom: 10px;
            font-size: 14px;
            background-color: rgba(255, 255, 255, 0.1);
            color: #ffffff;
        }

        .edit-form input:focus,
        .edit-form textarea:focus {
            outline: none;
            border-color: #3b82f6;
            background-color: rgba(255, 255, 255, 0.15);
        }

        .edit-form input::placeholder,
        .edit-form textarea::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .edit-form textarea {
            min-height: 80px;
            resize: vertical;
        }

        .no-data {
            text-align: center;
            padding: 40px;
            color: #e0e0e0;
            font-size: 16px;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #e0e0e0;
            font-size: 16px;
        }

        .success-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #10b981;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
<script>  
    document.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        alert('Автоматическое контекстное меню (по щелчку правой кнопкой мыши) отключено');
    });

    document.addEventListener('selectstart', function(e) {
        e.preventDefault();
    });

    document.addEventListener('keydown', function(e) {
        if ((e.ctrlKey || e.metaKey) && (e.key === 'c' || e.key === 'u' || e.key === 's' || e.key === 'a')) {
            e.preventDefault();
            alert('Функция копирования отключена.');
        }
    });

    document.addEventListener('keydown', function(e) {
        if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {
            e.preventDefault();
            alert('Инструменты разработчика отключены.');
        }
    });
</script>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col font-sans">
    <main class="main">
        <div style="padding: 2rem 0;">
            <h1 class="text-3xl font-bold text-center mb-8">Метаданные и информация об изображении</h1>
        </div>
        <div class="metadata-container">
                    <div class="sidebar-container">
                        <div class="sidebar">
                            <div class="sidebar-content">
                                <div class="upload-section">
                                    <button id="upload-btn" class="upload-btn">
                                        <i class="fas fa-upload"></i> Загрузить изображение
                                    </button>
                                    <input type="file" id="file-input" class="file-input" accept="image/jpeg,image/png,image/webp" multiple>
                                </div>

                                <div class="tools-section">
                                    <h2>Чтение метаданных</h2>
                                    <div class="tools-grid">
                                        <button class="tool-btn" data-module="reader" data-tool="exif" title="Бесплатные данные EXIF онлайн | CaliperTools" data-description="Просматривайте данные EXIF онлайн бесплатно. Мгновенно извлекайте настройки камеры. Регистрация не требуется. Лучшие результаты качества.">
                                            <i class="fas fa-info-circle"></i>
                                            <span>Данные EXIF</span>
                                        </button>
                                        <button class="tool-btn" data-module="reader" data-tool="gps" title="Бесплатная информация GPS онлайн | CaliperTools" data-description="Просматривайте информацию GPS онлайн бесплатно. Мгновенно извлекайте данные местоположения. Регистрация не требуется. Лучшие результаты качества.">
                                            <i class="fas fa-map-marker-alt"></i>
                                            <span>Информация GPS</span>
                                        </button>
                                        <button class="tool-btn" data-module="reader" data-tool="camera" title="Бесплатная информация о камере онлайн | CaliperTools" data-description="Просматривайте информацию о камере онлайн бесплатно. Мгновенно извлекайте данные устройства. Регистрация не требуется. Лучшие результаты качества.">
                                            <i class="fas fa-camera"></i>
                                            <span>Информация о камере</span>
                                        </button>
                                        <button class="tool-btn" data-module="reader" data-tool="date" title="Бесплатная дата съемки онлайн | CaliperTools" data-description="Просматривайте дату съемки онлайн бесплатно. Мгновенно извлекайте временные метки. Регистрация не требуется. Лучшие результаты качества.">
                                            <i class="fas fa-calendar"></i>
                                            <span>Дата съемки</span>
                                        </button>
                                        <button class="tool-btn" data-module="reader" data-tool="resolution" title="Бесплатное разрешение онлайн | CaliperTools" data-description="Просматривайте разрешение онлайн бесплатно. Мгновенно извлекайте размеры. Регистрация не требуется. Лучшие результаты качества.">
                                            <i class="fas fa-expand"></i>
                                            <span>Разрешение</span>
                                        </button>
                                        <button class="tool-btn" data-module="reader" data-tool="filesize" title="Бесплатный размер файла онлайн | CaliperTools" data-description="Просматривайте размер файла онлайн бесплатно. Мгновенно извлекайте данные о размере. Регистрация не требуется. Лучшие результаты качества.">
                                            <i class="fas fa-file"></i>
                                            <span>Размер файла</span>
                                        </button>
                                        <button class="tool-btn" data-module="reader" data-tool="colorprofile" title="Бесплатный цветовой профиль онлайн | CaliperTools" data-description="Просматривайте цветовой профиль онлайн бесплатно. Мгновенно извлекайте цветовые данные. Регистрация не требуется. Лучшие результаты качества.">
                                            <i class="fas fa-palette"></i>
                                            <span>Цветовой профиль</span>
                                        </button>
                                        <button class="tool-btn" data-module="reader" data-tool="orientation" title="Бесплатная ориентация онлайн | CaliperTools" data-description="Просматривайте ориентацию онлайн бесплатно. Мгновенно определяйте поворот. Регистрация не требуется. Лучшие результаты качества.">
                                            <i class="fas fa-sync-alt"></i>
                                            <span>Ориентация</span>
                                        </button>
                                    </div>
                                </div>

                                <div class="tools-section">
                                    <h2>Очистка конфиденциальности</h2>
                                    <div class="tools-grid">
                                        <button class="tool-btn" data-module="cleaner" data-tool="remove-exif" title="Бесплатное удаление EXIF онлайн | CaliperTools" data-description="Удаляйте данные EXIF онлайн бесплатно. Мгновенно защищайте конфиденциальность. Регистрация не требуется. Лучшие результаты качества.">
                                            <i class="fas fa-eraser"></i>
                                            <span>Удалить EXIF</span>
                                        </button>
                                        <button class="tool-btn" data-module="cleaner" data-tool="remove-gps" title="Бесплатное удаление GPS онлайн | CaliperTools" data-description="Удаляйте информацию GPS онлайн бесплатно. Мгновенно защищайте местоположение. Регистрация не требуется. Лучшие результаты качества.">
                                            <i class="fas fa-map-marker-slash"></i>
                                            <span>Удалить GPS</span>
                                        </button>
                                        <button class="tool-btn" data-module="cleaner" data-tool="batch-clean" title="Бесплатная пакетная очистка онлайн | CaliperTools" data-description="Пакетно очищайте метаданные онлайн бесплатно. Мгновенно удаляйте все данные. Регистрация не требуется. Лучшие результаты качества.">
                                            <i class="fas fa-broom"></i>
                                            <span>Пакетная очистка</span>
                                        </button>
                                    </div>
                                </div>

                                <div class="tools-section">
                                    <h2>Анализ изображения</h2>
                                    <div class="tools-grid">
                                        <button class="tool-btn" data-module="analysis" data-tool="histogram" title="Бесплатная гистограмма онлайн | CaliperTools" data-description="Просматривайте гистограмму онлайн бесплатно. Мгновенно анализируйте цвета. Регистрация не требуется. Лучшие результаты качества.">
                                            <i class="fas fa-chart-bar"></i>
                                            <span>Гистограмма</span>
                                        </button>
                                        <button class="tool-btn" data-module="analysis" data-tool="palette" title="Бесплатная цветовая палитра онлайн | CaliperTools" data-description="Просматривайте цветовую палитру онлайн бесплатно. Мгновенно извлекайте цвета. Регистрация не требуется. Лучшие результаты качества.">
                                            <i class="fas fa-swatchbook"></i>
                                            <span>Цветовая палитра</span>
                                        </button>
                                    </div>
                                </div>

                                <div class="tools-section">
                                    <h2>Редактор метаданных</h2>
                                    <div class="tools-grid">
                                        <button class="tool-btn" data-module="editor" data-tool="edit-exif" title="Бесплатное редактирование EXIF онлайн | CaliperTools" data-description="Редактируйте данные EXIF онлайн бесплатно. Мгновенно изменяйте метаданные. Регистрация не требуется. Лучшие результаты качества.">
                                            <i class="fas fa-edit"></i>
                                            <span>Редактировать EXIF</span>
                                        </button>
                                        <button class="tool-btn" data-module="editor" data-tool="remove-colorprofile" title="Бесплатное удаление профиля онлайн | CaliperTools" data-description="Удаляйте цветовой профиль онлайн бесплатно. Мгновенно очищайте изображение. Регистрация не требуется. Лучшие результаты качества.">
                                            <i class="fas fa-palette"></i>
                                            <span>Удалить профиль</span>
                                        </button>
                                    </div>
                                </div>

                                <div class="privacy-statement">
                                    <i class="fas fa-shield-alt" style="margin-right: 8px;"></i>
                                    Файлы обрабатываются локально и никогда не загружаются на какой-либо сервер.
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="preview-area">
                        <div id="upload-prompt" class="upload-prompt">
                            <div class="upload-prompt-icon">
                                <i class="fas fa-image"></i>
                            </div>
                            <div class="upload-prompt-title">Метаданные и информация об изображении</div>
                            <div class="upload-prompt-instruction">Нажмите здесь или перетащите изображения, чтобы начать анализ</div>
                            <p style="font-size: 14px; color: #666; margin-top: 10px;">Поддерживает: JPG, PNG, WebP (один или несколько)</p>
                        </div>

                        <div id="preview-wrapper" class="preview-wrapper">
                            <button id="delete-image-btn" class="delete-image-btn" title="Удалить изображение">
                                <i class="fas fa-times"></i>
                            </button>
                            <img id="preview-image" class="preview-image" alt="Preview">
                        </div>

                        <div id="result-panel" class="result-panel">
                        </div>
                    </div>
            </div>

    <!-- Tutorial Explanation Section -->
    <section class="tutorial-section">
        <div class="container">
            <h2 class="text-4xl">Как использовать инструмент метаданных изображений</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4">
                <!-- Step 1 -->
                <div class="tutorial-card">
                    <h3>
                        <span class="tutorial-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </span>
                        Загрузить изображение
                    </h3>
                    <div>
                        <p title="Перетащите изображение прямо в область загрузки или нажмите кнопку загрузки, чтобы выбрать с вашего устройства. Поддерживает форматы JPG, PNG и WebP.">Перетащите изображение прямо в область загрузки или нажмите кнопку загрузки, чтобы выбрать с вашего устройства. Поддерживает форматы JPG, PNG и WebP.</p>
                    </div>
                </div>
                <!-- Step 2 -->
                <div class="tutorial-card">
                    <h3>
                        <span class="tutorial-icon">
                            <i class="fas fa-search"></i>
                        </span>
                        Выбрать инструмент
                    </h3>
                    <div>
                        <p title="Выберите из 15 различных инструментов, организованных в 4 модуля: Чтение метаданных, Очистка конфиденциальности, Анализ изображений и Редактор метаданных.">Выберите из 15 различных инструментов, организованных в 4 модуля: Чтение метаданных, Очистка конфиденциальности, Анализ изображений и Редактор метаданных.</p>
                    </div>
                </div>
                <!-- Step 3 -->
                <div class="tutorial-card">
                    <h3>
                        <span class="tutorial-icon">
                            <i class="fas fa-eye"></i>
                        </span>
                        Просмотр результатов
                    </h3>
                    <div>
                        <p title="Просмотрите подробную информацию о метаданных, включая EXIF, GPS, настройки камеры и другое. Анализируйте свойства изображения и визуальные данные.">Просмотрите подробную информацию о метаданных, включая EXIF, GPS, настройки камеры и другое. Анализируйте свойства изображения и визуальные данные.</p>
                    </div>
                </div>
                <!-- Step 4 -->
                <div class="tutorial-card">
                    <h3>
                        <span class="tutorial-icon">
                            <i class="fas fa-download"></i>
                        </span>
                        Экспорт изображения
                    </h3>
                    <div>
                        <p title="Экспортируйте очищенные изображения с удаленными или отредактированными метаданными. Загружайте по отдельности или группами.">Экспортируйте очищенные изображения с удаленными или отредактированными метаданными. Загружайте по отдельности или группами.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Feature Introduction Section -->
    <section class="feature-section">
        <div class="container">
            <div class="grid-cols-2">
                <div class="content-image">
                    <img src="https://images.unsplash.com/photo-1719937206498-b31844530a96?w=600&h=400&fit=crop" alt="Image Metadata Tool" class="rounded-xl shadow-2xl w-full">
                </div>
                <div class="content-text">
                    <h2>Профессиональный анализ метаданных изображений</h2>
                    <p>Извлекайте и анализируйте метаданные изображений с точностью и легкостью. Наш инструмент предоставляет исчерпывающие данные EXIF, GPS, информацию о камере и технические характеристики.</p>
                    <p>Идеально подходит для фотографов, дизайнеров и всех, кто хочет понять свойства изображений.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Tool Features Section -->
    <section class="feature-section gray">
        <div class="container">
            <div class="grid-cols-2">
                <div class="content-text order-2 md:order-1">
                    <h2>4 мощных модуля</h2>
                    <p>От чтения метаданных до очистки конфиденциальности, от анализа изображений до продвинутого редактирования, наш инструмент имеет все, что вам нужно для профессионального управления метаданными изображений.</p>
                    <p>Защитите вашу конфиденциальность, удалив конфиденциальную информацию. Анализируйте визуальные данные с помощью гистограмм и цветовых палитр. Редактируйте и стандартизируйте метаданные для лучшей совместимости.</p>
                </div>
                <div class="content-image order-1 md:order-2">
                    <img src="https://images.unsplash.com/photo-1481762554390-ff5562748bdf?w=600&h=400&fit=crop" alt="Metadata Modules" class="rounded-xl shadow-2xl w-full">
                </div>
            </div>
        </div>
    </section>

    <!-- Privacy Security Section -->
    <section class="feature-section">
        <div class="container">
            <div class="grid-cols-2">
                <div class="content-image">
                    <img src="https://plus.unsplash.com/premium_photo-1700830193301-99e1c863ee38?w=600&h=400&fit=crop" alt="Privacy Protection" class="rounded-xl shadow-2xl w-full">
                </div>
                <div class="content-text">
                    <h2>100% защита конфиденциальности</h2>
                    <p>Вся обработка изображений происходит локально в вашем браузере. Ваши изображения никогда не загружаются ни на какие серверы.</p>
                    <p>Ваши данные остаются на вашем устройстве, обеспечивая полную конфиденциальность и безопасность для конфиденциальных изображений.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Mobile Support Section -->
    <section class="feature-section gray">
        <div class="container">
            <div class="grid-cols-2">
                <div class="content-text order-2 md:order-1">
                    <h2>Мобильная версия</h2>
                    <p>Анализируйте метаданные изображений в пути с помощью нашего мобильного дизайна. Наш инструмент отлично работает на смартфонах и планшетах, позволяя вам проверять свойства изображений где бы вы ни находились.</p>
                    <p>С адаптивным интерфейсом, который подстраивается под любой размер экрана, вы можете легко загружать, анализировать и скачивать изображения с помощью вашего мобильного устройства. Не нужно устанавливать приложения, просто откройте браузер и начните анализировать.</p>
                </div>
                <div class="content-image order-1 md:order-2">
                    <img src="https://images.unsplash.com/photo-1423666639041-f56000c27a9a?w=600&h=400&fit=crop" alt="Mobile-Friendly Design" class="rounded-xl shadow-2xl w-full">
                </div>
            </div>
        </div>
    </section>

    <!-- Bottom Text Section -->
    <section class="bottom-text-section">
        <div class="container">
            <h2>Легко анализируйте метаданные изображений бесплатно</h2>
            <p>Прощайте сложное программное обеспечение для анализа метаданных изображений. С помощью CaliperTools Image Metadata вы можете без усилий извлекать и анализировать информацию о изображениях бесплатно. Лучшая часть в том, что вы можете использовать наш инструмент с любого устройства с браузером, без загрузки или установки. Опыт не требуется!</p>
            <p>Используйте редактор перетаскивания для загрузки ваших изображений, а CaliperTools Image Metadata выполнит остальную работу. Когда закончите, скачайте ваши очищенные или отредактированные изображения. Анализируйте столько картинок, сколько хотите, все это за несколько кликов.</p>
            
            <h2>Комплексный анализ метаданных каждый раз</h2>
            <p>Извлекайте подробные данные EXIF, координаты GPS, настройки камеры и технические характеристики из ваших изображений. Наши продвинутые инструменты анализа обеспечивают получение точной информации при сохранении качества изображения.</p>
            <p>С нашими встроенными функциями очистки конфиденциальности и редактирования вы можете удалять конфиденциальные метаданные, редактировать поля EXIF и стандартизировать цветовые профили. Защитите вашу конфиденциальность и улучшите совместимость изображений с идеально проанализированными изображениями.</p>
        </div>
    </section>

    <!-- Related Tools Section -->
    <section class="related-tools">
        <div class="container">
            <h2 class="section-title">Связанные инструменты</h2>
            <div class="tools-grid" id="relatedTools">
                <!-- Related tools will be dynamically generated by JS -->
            </div>
        </div>
    </section>

    <!-- Related Tools Script -->
    <script src="../scripts/script-related-tools.js"></script>
    <script>
        // Initialize related tools
        document.addEventListener('DOMContentLoaded', function() {
            const currentSlug = 'image-metadata-tool';
            if (typeof initRelatedTools === 'function') {
                initRelatedTools(currentSlug);
            }
        });
    </script>

    <script>
        let currentImage = null;
        let currentFile = null;
        let currentTool = null;
        let currentModule = null;
        let exifData = null;

        const uploadBtn = document.getElementById('upload-btn');
        const fileInput = document.getElementById('file-input');
        const uploadPrompt = document.getElementById('upload-prompt');
        const previewWrapper = document.getElementById('preview-wrapper');
        const previewImage = document.getElementById('preview-image');
        const resultPanel = document.getElementById('result-panel');
        const deleteImageBtn = document.getElementById('delete-image-btn');
        const toolButtons = document.querySelectorAll('.tool-btn');

        function handleUrlParams() {
            const pathname = window.location.pathname;
            const segments = pathname.split('/');
            const toolParam = segments[segments.length - 1];
            
            if (toolParam && toolParam !== 'Image-Metadata.html') {
                const toolBtn = document.querySelector('.tool-btn[data-tool="' + toolParam + '"]');
                if (toolBtn) {
                    toolBtn.click();
                }
            }
        }

        function init() {
            setupEventListeners();
            handleUrlParams();
        }

        function setupEventListeners() {
            uploadBtn.addEventListener('click', function() {
                fileInput.click();
            });

            uploadPrompt.addEventListener('click', function() {
                fileInput.click();
            });

            fileInput.addEventListener('change', handleFileUpload);

            const previewArea = document.querySelector('.preview-area');
            previewArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadPrompt.classList.add('drag-over');
            });

            previewArea.addEventListener('dragleave', function() {
                uploadPrompt.classList.remove('drag-over');
            });

            previewArea.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadPrompt.classList.remove('drag-over');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    loadImages(files);
                }
            });

            deleteImageBtn.addEventListener('click', function() {
                currentImage = null;
                currentFile = null;
                uploadPrompt.style.display = 'flex';
                previewWrapper.classList.remove('active');
                resultPanel.classList.remove('active');
                resultPanel.innerHTML = '';
                
                document.title = 'Бесплатный онлайн-просмотр метаданных изображений | CaliperTools';
                const metaDescription = document.querySelector('meta[name="description"]');
                if (metaDescription) {
                    metaDescription.setAttribute('content', 'Просматривайте метаданные изображений онлайн бесплатно. Мгновенно извлекайте данные EXIF, GPS, информацию о камере. Регистрация не требуется. Лучшие результаты качества.');
                }
                
                const newUrl = new URL(window.location.href);
                // 确保无论当前URL是什么，都返回正确的基础URL
                const segments = newUrl.pathname.split('/');
                // 找到ru目录的位置
                const langIndex = segments.indexOf('ru');
                if (langIndex !== -1) {
                    // 构建正确的路径：ru/Image/Image-Metadata.html
                    newUrl.pathname = segments.slice(0, langIndex + 1).join('/') + '/Image/Image-Metadata.html';
                } else {
                    //  fallback：如果找不到ru目录，直接使用根目录
                    newUrl.pathname = '/ru/Image/Image-Metadata.html';
                }
                window.history.pushState({}, '', newUrl);
                
                toolButtons.forEach(function(b) {
                    b.classList.remove('active');
                });
                currentTool = null;
                currentModule = null;
            });

            toolButtons.forEach(function(btn) {
                btn.addEventListener('click', function() {
                    if (!currentImage) {
                        alert('Пожалуйста, сначала загрузите изображение');
                        return;
                    }

                    const tool = btn.dataset.tool;
                    const module = btn.dataset.module;

                    toolButtons.forEach(function(b) {
                        b.classList.remove('active');
                    });
                    btn.classList.add('active');
                    currentTool = tool;
                    currentModule = module;

                    const toolTitle = btn.getAttribute('title');
                    const toolDescription = btn.getAttribute('data-description');
                    if (toolTitle) {
                        document.title = toolTitle;
                    }
                    
                    if (toolDescription) {
                        const metaDescription = document.querySelector('meta[name="description"]');
                        if (metaDescription) {
                            metaDescription.setAttribute('content', toolDescription);
                        }
                    }

                    const newUrl = new URL(window.location.href);
                    // 直接构建正确的路径，不依赖当前URL结构
                    const segments = newUrl.pathname.split('/');
                    // 找到ru目录的位置
                    const langIndex = segments.indexOf('ru');
                    if (langIndex !== -1) {
                        // 构建正确的路径：/ru/Image/Image-Metadata/tool
                        newUrl.pathname = segments.slice(0, langIndex + 1).join('/') + '/Image/Image-Metadata/' + tool;
                    } else {
                        //  fallback：如果找不到ru目录，直接使用根目录
                        newUrl.pathname = '/ru/Image/Image-Metadata/' + tool;
                    }
                window.history.pushState({}, '', newUrl);

                    executeTool(tool, module);
                });
            });
        }

        function handleFileUpload(e) {
            const files = e.target.files;
            if (files.length > 0) {
                loadImages(files);
            }
        }

        function loadImages(files) {
            if (files.length === 1) {
                loadSingleImage(files[0]);
            } else if (files.length > 1) {
                loadMultipleImages(files);
            }
        }

        function loadSingleImage(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    currentImage = img;
                    currentFile = file;

                    console.log('File type:', file.type);
                    console.log('File name:', file.name);
                    console.log('File size:', (file.size / 1024).toFixed(2), 'KB');
                    console.log('Image loaded:', img.width, 'x', img.height);
                    console.log('Image natural size:', img.naturalWidth, 'x', img.naturalHeight);

                    const maxWidth = 800;
                    const maxHeight = 600;
                    let width = img.width;
                    let height = img.height;

                    if (width > maxWidth) {
                        height = (maxWidth / width) * height;
                        width = maxWidth;
                    }
                    if (height > maxHeight) {
                        width = (maxHeight / height) * width;
                        height = maxHeight;
                    }

                    previewImage.src = e.target.result;
                    previewWrapper.style.width = width + 'px';
                    previewWrapper.style.height = height + 'px';

                    uploadPrompt.style.display = 'none';
                    previewWrapper.classList.add('active');

                    setTimeout(function() {
                        try {
                            console.log('=== EXIF Reading Attempt ===');
                            console.log('window.EXIF:', window.EXIF);
                            console.log('typeof window.EXIF.getData:', typeof window.EXIF.getData);
                            
                            if (window.EXIF && typeof window.EXIF.getData === 'function') {
                                console.log('Calling EXIF.getData on img element...');
                                window.EXIF.getData(img, function() {
                                    console.log('=== EXIF Data Loaded ===');
                                    
                                    exifData = {};
                                    
                                    var make = window.EXIF.getTag(this, 'Make');
                                    var model = window.EXIF.getTag(this, 'Model');
                                    var software = window.EXIF.getTag(this, 'Software');
                                    var dateTime = window.EXIF.getTag(this, 'DateTime');
                                    var dateTimeOriginal = window.EXIF.getTag(this, 'DateTimeOriginal');
                                    var exposureTime = window.EXIF.getTag(this, 'ExposureTime');
                                    var fNumber = window.EXIF.getTag(this, 'FNumber');
                                    var iso = window.EXIF.getTag(this, 'ISOSpeedRatings');
                                    var focalLength = window.EXIF.getTag(this, 'FocalLength');
                                    var copyright = window.EXIF.getTag(this, 'Copyright');
                                    var imageDescription = window.EXIF.getTag(this, 'ImageDescription');
                                    var gpsLatitude = window.EXIF.getTag(this, 'GPSLatitude');
                                    var gpsLongitude = window.EXIF.getTag(this, 'GPSLongitude');
                                    var gpsLatitudeRef = window.EXIF.getTag(this, 'GPSLatitudeRef');
                                    var gpsLongitudeRef = window.EXIF.getTag(this, 'GPSLongitudeRef');
                                    var gpsAltitude = window.EXIF.getTag(this, 'GPSAltitude');
                                    var gpsImgDirection = window.EXIF.getTag(this, 'GPSImgDirection');
                                    var gpsSpeed = window.EXIF.getTag(this, 'GPSSpeed');
                                    
                                    if (make) exifData.Make = make;
                                    if (model) exifData.Model = model;
                                    if (software) exifData.Software = software;
                                    if (dateTimeOriginal) exifData.DateTimeOriginal = dateTimeOriginal;
                                    if (dateTime) exifData.DateTime = dateTime;
                                    if (exposureTime) exifData.ExposureTime = exposureTime;
                                    if (fNumber) exifData.FNumber = fNumber;
                                    if (iso) exifData.ISOSpeedRatings = iso;
                                    if (focalLength) exifData.FocalLength = focalLength;
                                    if (copyright) exifData.Copyright = copyright;
                                    if (imageDescription) exifData.ImageDescription = imageDescription;
                                    if (gpsLatitude) exifData.GPSLatitude = gpsLatitude;
                                    if (gpsLongitude) exifData.GPSLongitude = gpsLongitude;
                                    if (gpsLatitudeRef) exifData.GPSLatitudeRef = gpsLatitudeRef;
                                    if (gpsLongitudeRef) exifData.GPSLongitudeRef = gpsLongitudeRef;
                                    if (gpsAltitude) exifData.GPSAltitude = gpsAltitude;
                                    if (gpsImgDirection) exifData.GPSImgDirection = gpsImgDirection;
                                    if (gpsSpeed) exifData.GPSSpeed = gpsSpeed;
                                    
                                    console.log('EXIF data extracted:', exifData);
                                    console.log('EXIF keys:', Object.keys(exifData));
                                    console.log('GPSLatitude:', exifData.GPSLatitude);
                                    console.log('GPSLongitude:', exifData.GPSLongitude);
                                });
                            } else {
                                console.log('EXIF library not available');
                                exifData = null;
                            }
                        } catch (err) {
                            console.log('Error reading EXIF:', err);
                            exifData = null;
                        }
                    }, 300);
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function loadMultipleImages(files) {
            currentImage = { multiple: true, files: files };
            currentFile = { multiple: true, files: files };

            uploadPrompt.style.display = 'none';
            previewWrapper.classList.add('active');

            const previewHTML = '<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px; padding: 10px; max-height: 100%; overflow-y: auto;">' +
                Array.from(files).map((file, index) => '<div style="border: 1px solid #ddd; border-radius: 8px; padding: 10px; text-align: center;"><i class="fas fa-image" style="font-size: 40px; color: #007bff; margin-bottom: 10px;"></i><div style="font-size: 12px; color: #666; word-break: break-all;">' + file.name + '</div></div>').join('') +
                '</div>';
            previewWrapper.innerHTML = previewHTML;
        }

        function executeTool(tool, module) {
            resultPanel.innerHTML = '';
            resultPanel.classList.add('active');

            if (module === 'reader') {
                executeReaderTool(tool);
            } else if (module === 'cleaner') {
                executeCleanerTool(tool);
            } else if (module === 'analysis') {
                executeAnalysisTool(tool);
            } else if (module === 'editor') {
                executeEditorTool(tool);
            }
        }

        function executeReaderTool(tool) {
            let html = '';
            let hasData = true;

            if (tool === 'exif') {
                html = generateExifTable();
            } else if (tool === 'gps') {
                html = generateGpsTable();
            } else if (tool === 'camera') {
                html = generateCameraTable();
            } else if (tool === 'date') {
                html = generateDateTable();
            } else if (tool === 'resolution') {
                html = generateResolutionTable();
            } else if (tool === 'filesize') {
                html = generateFileSizeTable();
            } else if (tool === 'colorprofile') {
                html = generateColorProfileTable();
            } else if (tool === 'orientation') {
                html = generateOrientationTable();
            }

            if (!hasData) {
                html = '<div class="no-data"><i class="fas fa-exclamation-circle" style="font-size: 48px; margin-bottom: 15px;"></i><p>Метаданные недоступны для этого изображения</p></div>';
            }

            resultPanel.innerHTML = '<h3>' + getToolTitle(tool) + '</h3>' + html;
        }

        function executeCleanerTool(tool) {
            let html = '';
            let showDownload = true;

            if (tool === 'remove-exif') {
                html = generateRemoveExifInfo();
            } else if (tool === 'remove-gps') {
                html = generateRemoveGpsInfo();
            } else if (tool === 'batch-clean') {
                html = generateBatchCleanInfo();
                showDownload = currentFile && currentFile.multiple;
            }

            if (!showDownload) {
                resultPanel.innerHTML = '<h3>' + getToolTitle(tool) + '</h3>' + html;
            } else {
                resultPanel.innerHTML = '<h3>' + getToolTitle(tool) + '</h3>' + html + '<div class="download-section"><button class="download-btn" onclick="downloadCleaned(\'' + tool + '\')"><i class="fas fa-download"></i> Download Cleaned Image</button></div>';
            }
        }

        function executeAnalysisTool(tool) {
            let html = '';

            if (tool === 'histogram') {
                html = generateHistogram();
                setTimeout(function() { 
                    console.log('Executing generateHistogramData...');
                    generateHistogramData(); 
                }, 500);
            } else if (tool === 'palette') {
                html = generateColorPalette();
                setTimeout(function() { 
                    console.log('Executing getMockColorPalette...');
                    getMockColorPalette(); 
                }, 500);
            }

            resultPanel.innerHTML = '<h3>' + getToolTitle(tool) + '</h3>' + html;
        }

        function executeEditorTool(tool) {
            let html = '';

            if (tool === 'edit-exif') {
                html = generateEditExifForm();
            } else if (tool === 'remove-colorprofile') {
                html = generateRemoveColorProfileInfo();
            }

            const showDownload = tool === 'edit-exif';

            if (showDownload) {
                resultPanel.innerHTML = '<h3>' + getToolTitle(tool) + '</h3>' + html + '<div class="download-section"><button class="download-btn" onclick="downloadEdited(\'' + tool + '\')"><i class="fas fa-download"></i> Download Edited Image</button></div>';
            } else {
                resultPanel.innerHTML = '<h3>' + getToolTitle(tool) + '</h3>' + html;
            }
        }

        function getToolTitle(tool) {
            const titles = {
                'exif': 'Данные EXIF',
                'gps': 'Информация GPS',
                'camera': 'Информация о камере',
                'date': 'Дата съемки',
                'resolution': 'Разрешение',
                'filesize': 'Размер файла',
                'colorprofile': 'Цветовой профиль',
                'orientation': 'Ориентация изображения',
                'remove-exif': 'Удалить данные EXIF',
                'remove-gps': 'Удалить информацию GPS',
                'batch-clean': 'Пакетная очистка метаданных',
                'histogram': 'Гистограмма RGB',
                'palette': 'Цветовая палитра',
                'edit-exif': 'Редактировать данные EXIF',
                'remove-colorprofile': 'Удалить цветовой профиль'
            };
            return titles[tool] || tool;
        }

        function generateExifTable() {
            const exifData = getExifData();
            if (exifData.length === 0) {
                return '<div class="no-data"><i class="fas fa-exclamation-circle" style="font-size: 48px; margin-bottom: 15px;"></i><p>Данные EXIF недоступны для этого изображения</p></div>';
            }
            return '<table class="result-table"><thead><tr><th>Тег</th><th>Значение</th></tr></thead><tbody>' +
                exifData.map(item => '<tr><td>' + item.tag + '</td><td>' + item.value + '</td></tr>').join('') +
                '</tbody></table>';
        }

        function generateGpsTable() {
            const gpsData = getGpsData();
            if (!gpsData) {
                return '<div class="no-data"><i class="fas fa-map-marker-slash" style="font-size: 48px; margin-bottom: 15px;"></i><p>Информация GPS не найдена в этом изображении</p></div>';
            }
            return '<div class="result-info"><h4>Координаты GPS</h4><p><strong>Широта:</strong> ' + gpsData.latitude + '</p><p><strong>Долгота:</strong> ' + gpsData.longitude + '</p><p><strong>Высота:</strong> ' + gpsData.altitude + '</p></div>' +
                '<div class="result-info"><h4>Детали местоположения</h4><p><strong>Направление:</strong> ' + gpsData.direction + '</p><p><strong>Скорость:</strong> ' + gpsData.speed + '</p></div>';
        }

        function generateCameraTable() {
            const cameraData = getCameraData();
            return '<table class="result-table"><thead><tr><th>Свойство</th><th>Значение</th></tr></thead><tbody>' +
                cameraData.map(item => '<tr><td>' + item.property + '</td><td>' + item.value + '</td></tr>').join('') +
                '</tbody></table>';
        }

        function generateDateTable() {
            const dateData = getDateData();
            return '<div class="result-info"><h4>Оригинальная дата съемки</h4><p><strong>Дата:</strong> ' + dateData.date + '</p><p><strong>Время:</strong> ' + dateData.time + '</p><p><strong>Часовой пояс:</strong> ' + dateData.timezone + '</p></div>' +
                '<div class="result-info"><h4>Информация о файле</h4><p><strong>Изменен:</strong> ' + dateData.modified + '</p><p><strong>Создан:</strong> ' + dateData.created + '</p></div>';
        }

        function generateResolutionTable() {
            const resolutionData = getResolutionData();
            return '<div class="result-info"><h4>Размеры изображения</h4><p><strong>Ширина:</strong> ' + resolutionData.width + ' пикселей</p><p><strong>Высота:</strong> ' + resolutionData.height + ' пикселей</p><p><strong>Всего пикселей:</strong> ' + resolutionData.total.toLocaleString() + '</p></div>' +
                '<div class="result-info"><h4>Соотношение сторон</h4><p><strong>Соотношение:</strong> ' + resolutionData.ratio + '</p><p><strong>Ориентация:</strong> ' + resolutionData.orientation + '</p></div>';
        }

        function generateFileSizeTable() {
            const sizeData = getFileSizeData();
            return '<div class="result-info"><h4>Оригинальный размер файла</h4><p><strong>Размер:</strong> ' + sizeData.originalSize + '</p><p><strong>Формат:</strong> ' + sizeData.format + '</p></div>' +
                '<div class="result-info"><h4>Сравнение размеров</h4><p><strong>После удаления EXIF:</strong> ' + sizeData.afterRemoval + '</p><p><strong>Экономия:</strong> ' + sizeData.saved + '</p></div>';
        }

        function generateColorProfileTable() {
            const profileData = getColorProfileData();
            return '<div class="result-info"><h4>Цветовой профиль</h4><p><strong>Профиль:</strong> ' + profileData.profile + '</p><p><strong>Цветовое пространство:</strong> ' + profileData.colorSpace + '</p></div>' +
                '<div class="result-info"><h4>Детали профиля</h4><p><strong>Глубина цвета:</strong> ' + profileData.bitDepth + '</p><p><strong>ICC Профиль:</strong> ' + profileData.iccProfile + '</p></div>';
        }

        function generateOrientationTable() {
            const orientationData = getOrientationData();
            return '<div class="result-info"><h4>EXIF Ориентация</h4><p><strong>Значение ориентации:</strong> ' + orientationData.exifValue + '</p><p><strong>Необходимый поворот:</strong> ' + orientationData.rotationNeeded + '</p></div>' +
                '<div class="result-info"><h4>Размеры изображения</h4><p><strong>Ширина:</strong> ' + orientationData.width + ' px</p><p><strong>Высота:</strong> ' + orientationData.height + ' px</p><p><strong>Соотношение сторон:</strong> ' + orientationData.ratio + '</p></div>';
        }

        function generateRemoveExifInfo() {
            return '<div class="result-info"><h4>Удалить данные EXIF</h4><p>Это приведет к удалению всех метаданных EXIF из изображения с сохранением оригинального качества изображения.</p><p><strong>Что будет удалено:</strong></p><ul style="margin-left: 20px; margin-top: 10px;"><li>Марка и модель камеры</li><li>GPS-координаты</li><li>Информация о дате и времени</li><li>Информация об авторских правах и авторе</li><li>Детали программного обеспечения и оборудования</li></ul></div>' +
                '<div class="result-info"><h4>Что будет сохранено:</h4><p><strong>Сохранено:</strong></p><ul style="margin-left: 20px; margin-top: 10px;"><li>Качество изображения и разрешение</li><li>Цветовой профиль</li><li>Внешний вид</li><li>Формат файла</li></ul></div>';
        }

        function generateRemoveGpsInfo() {
            return '<div class="result-info"><h4>Удалить информацию GPS</h4><p>Это приведет к удалению только метаданных, связанных с GPS, при сохранении другой информации EXIF.</p><p><strong>Что будет удалено:</strong></p><ul style="margin-left: 20px; margin-top: 10px;"><li>GPS-координаты (широта, долгота)</li><li>Информация о высоте</li><li>Данные о направлении и скорости</li><li>Временные метки местоположения</li></ul></div>' +
                '<div class="result-info"><h4>Что будет сохранено:</h4><p><strong>Сохранено:</strong></p><ul style="margin-left: 20px; margin-top: 10px;"><li>Информация о камере</li><li>Дата и время</li><li>Авторские права и автор</li><li>Другие данные EXIF</li></ul></div>';
        }

        function generateBatchCleanInfo() {
            const fileCount = currentFile && currentFile.multiple ? currentFile.files.length : 1;
            return '<div class="result-info"><h4>Пакетный очиститель метаданных</h4><p>Удалить все метаданные из ' + fileCount + ' изображения(ий) за один раз.</p><p><strong>Файлы для обработки:</strong> ' + fileCount + '</p></div>' +
                '<div class="result-info"><h4>Что будет удалено:</h4><p><strong>Все метаданные:</strong></p><ul style="margin-left: 20px; margin-top: 10px;"><li>Данные EXIF</li><li>Информация GPS</li><li>Настройки камеры</li><li>Дата и время</li><li>Авторские права и автор</li><li>Информация о программном обеспечении</li></ul></div>';
        }

        function generateHistogram() {
            return '<div class="result-info"><h4>Гистограмма RGB</h4><p>Визуальное представление распределения цветов в вашем изображении.</p></div>' +
                '<div class="histogram-container"><canvas id="histogram-canvas" style="width: 100%; height: 300px;"></canvas></div>' +
                '<script>setTimeout(function() { generateHistogramData(); }, 100); <\/script>';
        }

        function generateColorPalette() {
            console.log('generateColorPalette called');
            const colors = getMockColorPalette();
            console.log('Colors to display:', colors);
            return '<div class="result-info"><h4>Цветовая палитра</h4><p>Извлеченные доминирующие цвета из вашего изображения.</p></div>' +
                '<div class="color-palette">' +
                colors.map(color => '<div class="color-swatch" style="background-color: ' + color.hex + ';"><span>' + color.hex + '</span></div>').join('') +
                '</div>';
        }

        function generateEditExifForm() {
            const exifData = getExifData();
            const copyrightItem = exifData.find(function(d) { return d.tag === 'Copyright'; });
            const copyright = copyrightItem ? copyrightItem.value : '';
            const descriptionItem = exifData.find(function(d) { return d.tag === 'Image Description'; });
            const description = descriptionItem ? descriptionItem.value : '';
            const softwareItem = exifData.find(function(d) { return d.tag === 'Software'; });
            const software = softwareItem ? softwareItem.value : '';
            
            return '<div class="edit-form">' +
                '<label for="author">Автор / Авторские права</label>' +
                '<input type="text" id="edit-author" value="' + copyright + '" placeholder="Введите имя автора">' +
                '<label for="description">Описание изображения</label>' +
                '<textarea id="edit-description" placeholder="Введите описание изображения">' + description + '</textarea>' +
                '<label for="software">Название программного обеспечения</label>' +
                '<input type="text" id="edit-software" value="' + software + '" placeholder="Введите название программного обеспечения">' +
                '</div>';
        }

        function generateRemoveColorProfileInfo() {
            return '<div class="result-info"><h4>Удалить цветовой профиль</h4><p>Это приведет к удалению или стандартизации встроенного цветового профиля из изображения.</p><p><strong>Что произойдет:</strong></p><ul style="margin-left: 20px; margin-top: 10px;"><li>Удалить встроенный ICC-профиль</li><li>Конвертировать в цветовое пространство sRGB</li><li>Сохранить визуальный внешний вид</li><li>Улучшить кросс-платформенную совместимость</li></ul></div>' +
                '<div class="result-info"><h4>Преимущества:</h4><p><strong>Зачем его удалять:</strong></p><ul style="margin-left: 20px; margin-top: 10px;"><li>Более согласованные цвета на разных устройствах</li><li>Меньший размер файлов</li><li>Лучшая веб-совместимость</li><li>Предотвратить сдвиги цвета</li></ul></div>';
        }

        function getExifData() {
            console.log('getExifData called, exifData:', exifData);
            
            if (!exifData) {
                console.log('exifData is null or undefined');
                return [];
            }

            const data = [];
            
            console.log('Checking EXIF properties...');
            console.log('Make:', exifData.Make);
            console.log('Model:', exifData.Model);
            console.log('Software:', exifData.Software);
            console.log('DateTime:', exifData.DateTimeOriginal);
            console.log('ExposureTime:', exifData.ExposureTime);
            console.log('FNumber:', exifData.FNumber);
            console.log('ISO:', exifData.ISOSpeedRatings);
            console.log('FocalLength:', exifData.FocalLength);
            console.log('Copyright:', exifData.Copyright);
            console.log('ImageDescription:', exifData.ImageDescription);
            
            if (exifData.Make) {
                data.push({ tag: 'Make', value: exifData.Make });
            }
            if (exifData.Model) {
                data.push({ tag: 'Model', value: exifData.Model });
            }
            if (exifData.Software) {
                data.push({ tag: 'Software', value: exifData.Software });
            }
            if (exifData.DateTimeOriginal) {
                data.push({ tag: 'Date/Time', value: exifData.DateTimeOriginal });
            }
            if (exifData.ExposureTime) {
                data.push({ tag: 'Exposure Time', value: exifData.ExposureTime + ' s' });
            }
            if (exifData.FNumber) {
                data.push({ tag: 'F-Number', value: 'f/' + exifData.FNumber });
            }
            if (exifData.ISOSpeedRatings) {
                data.push({ tag: 'ISO', value: exifData.ISOSpeedRatings });
            }
            if (exifData.FocalLength) {
                data.push({ tag: 'Focal Length', value: exifData.FocalLength + 'mm' });
            }
            if (exifData.Copyright) {
                data.push({ tag: 'Copyright', value: exifData.Copyright });
            }
            if (exifData.ImageDescription) {
                data.push({ tag: 'Image Description', value: exifData.ImageDescription });
            }

            console.log('Final EXIF data array:', data);
            return data;
        }

        function getGpsData() {
            if (!exifData || !exifData.GPSLatitude || !exifData.GPSLongitude) {
                return null;
            }

            const lat = exifData.GPSLatitude;
            const latRef = exifData.GPSLatitudeRef || 'N';
            const lon = exifData.GPSLongitude;
            const lonRef = exifData.GPSLongitudeRef || 'E';

            const convertDMSToDD = function(dms, ref) {
                const degrees = dms[0] + dms[1] / 60 + dms[2] / 3600;
                return (ref === 'S' || ref === 'W') ? -degrees : degrees;
            };

            const latitude = convertDMSToDD(lat, latRef).toFixed(6) + '° ' + latRef;
            const longitude = convertDMSToDD(lon, lonRef).toFixed(6) + '° ' + lonRef;
            const altitude = exifData.GPSAltitude ? exifData.GPSAltitude + ' метров' : 'Н/Д';

            return {
                latitude: latitude,
                longitude: longitude,
                altitude: altitude,
                direction: exifData.GPSImgDirection ? exifData.GPSImgDirection + '°' : 'Н/Д',
                speed: exifData.GPSSpeed ? exifData.GPSSpeed + ' км/ч' : 'Н/Д'
            };
        }

        function getCameraData() {
            if (!exifData) {
                return [];
            }

            const data = [];
            
            if (exifData.Make) {
                data.push({ property: 'Марка камеры', value: exifData.Make });
            }
            if (exifData.Model) {
                data.push({ property: 'Модель камеры', value: exifData.Model });
            }
            if (exifData.FocalLength) {
                data.push({ property: 'Фокусное расстояние', value: exifData.FocalLength + 'mm' });
            }
            if (exifData.FNumber) {
                data.push({ property: 'Диафрагма', value: 'f/' + exifData.FNumber });
            }
            if (exifData.ExposureTime) {
                data.push({ property: 'Выдержка', value: '1/' + Math.round(1 / exifData.ExposureTime) + ' s' });
            }
            if (exifData.ISOSpeedRatings) {
                data.push({ property: 'ISO', value: exifData.ISOSpeedRatings });
            }
            if (exifData.Flash) {
                data.push({ property: 'Вспышка', value: exifData.Flash ? 'Вкл' : 'Выкл' });
            }

            return data;
        }

        function getDateData() {
            if (!exifData) {
                return {
                    date: 'Н/Д',
                    time: 'Н/Д',
                    timezone: 'Н/Д',
                    modified: currentFile ? new Date(currentFile.lastModified).toLocaleString() : 'Н/Д',
                    created: currentFile ? new Date(currentFile.lastModified).toLocaleString() : 'Н/Д'
                };
            }

            return {
                date: exifData.DateTimeOriginal ? exifData.DateTimeOriginal.split(' ')[0] : 'Н/Д',
                time: exifData.DateTimeOriginal ? exifData.DateTimeOriginal.split(' ')[1] : 'Н/Д',
                timezone: 'Н/Д',
                modified: currentFile ? new Date(currentFile.lastModified).toLocaleString() : 'Н/Д',
                created: currentFile ? new Date(currentFile.lastModified).toLocaleString() : 'Н/Д'
            };
        }

        function getResolutionData() {
            if (!currentImage) {
                return {
                    width: 0,
                    height: 0,
                    total: 0,
                    ratio: 'Н/Д',
                    orientation: 'Н/Д'
                };
            }

            const width = currentImage.width;
            const height = currentImage.height;
            const total = width * height;
            const gcd = function(a, b) {
                while (b) {
                    let temp = b;
                    b = a % b;
                    a = temp;
                }
                return a;
            };
            const divisor = gcd(width, height);
            const orientation = width > height ? 'Горизонтальная' : (width < height ? 'Вертикальная' : 'Квадратная');

            return {
                width: width,
                height: height,
                total: total,
                ratio: (width / divisor) + ':' + (height / divisor),
                orientation: orientation
            };
        }

        function getFileSizeData() {
            if (!currentFile) {
                return {
                    originalSize: 'Н/Д',
                    format: 'Н/Д',
                    afterRemoval: 'Н/Д',
                    saved: 'Н/Д'
                };
            }

            const originalSize = (currentFile.size / 1024 / 1024).toFixed(2);
            const afterRemoval = (originalSize * 0.9).toFixed(2);
            const saved = (originalSize - afterRemoval).toFixed(2);
            const format = currentFile.name.split('.').pop().toUpperCase();

            return {
                originalSize: originalSize + ' MB',
                format: format,
                afterRemoval: afterRemoval + ' MB',
                saved: saved + ' MB (' + ((saved / originalSize) * 100).toFixed(1) + '%)'
            };
        }

        function getColorProfileData() {
            if (!exifData) {
                return {
                    profile: 'Н/Д',
                    colorSpace: 'Н/Д',
                    bitDepth: 'Н/Д',
                    iccProfile: 'Н/Д'
                };
            }

            return {
                profile: exifData.ColorSpace || 'sRGB',
                colorSpace: exifData.ColorSpace || 'RGB',
                bitDepth: '8 бит на канал',
                iccProfile: exifData.ColorSpace ? 'Встроенный ICC-профиль обнаружен' : 'Встроенный профиль отсутствует'
            };
        }

        function getOrientationData() {
            if (!exifData) {
                return {
                    exifValue: 'Н/Д',
                    rotationNeeded: 'Н/Д',
                    width: currentImage ? currentImage.width : 0,
                    height: currentImage ? currentImage.height : 0,
                    ratio: currentImage ? (currentImage.width / currentImage.height).toFixed(2) : 'Н/Д'
                };
            }

            const orientation = exifData.Orientation || 1;
            const rotationMap = {
                1: 'Поворот не требуется',
                2: 'Отразить горизонтально',
                3: 'Повернуть на 180°',
                4: 'Отразить вертикально',
                5: 'Повернуть на 90° по часовой стрелке + отразить горизонтально',
                6: 'Повернуть на 90° по часовой стрелке',
                7: 'Повернуть на 90° против часовой стрелки + отразить горизонтально',
                8: 'Повернуть на 90° против часовой стрелки'
            };

            return {
                exifValue: orientation + ' (' + (rotationMap[orientation] || 'Неизвестно') + ')',
                rotationNeeded: rotationMap[orientation] || 'Неизвестно',
                width: currentImage ? currentImage.width : 0,
                height: currentImage ? currentImage.height : 0,
                ratio: currentImage ? (currentImage.width / currentImage.height).toFixed(2) : 'Н/Д'
            };
        }

        function getMockColorPalette() {
            if (!currentImage) {
                console.log('No current image, using default colors');
                return [
                    { hex: '#2C3E50', name: 'Темно-синий' },
                    { hex: '#34495E', name: 'Серо-голубой' },
                    { hex: '#E74C3C', name: 'Нежно-красный' },
                    { hex: '#ECF0F1', name: 'Светло-голубой' },
                    { hex: '#95A5A6', name: 'Бирюзовый' },
                    { hex: '#F39C12', name: 'Оранжевый' },
                    { hex: '#D35400', name: 'Темно-оранжевый' },
                    { hex: '#E8E8E8', name: 'Светло-серый' }
                ];
            }

            console.log('Extracting colors from image:', currentImage.width, 'x', currentImage.height);

            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 300;
            canvas.height = 300;
            ctx.drawImage(currentImage, 0, 0, 300, 300);

            const imageData = ctx.getImageData(0, 0, 300, 300);
            const data = imageData.data;
            const colorCounts = {};
            const totalPixels = data.length / 4;

            console.log('Total pixels to analyze:', totalPixels);

            for (let i = 0; i < data.length; i += 4) {
                const r = data[i];
                const g = data[i + 1];
                const b = data[i + 2];
                
                const hex = '#' + [r, g, b].map(function(x) {
                    const hex = x.toString(16);
                    return hex.length === 1 ? '0' + hex : hex;
                }).join('');

                if (colorCounts[hex]) {
                    colorCounts[hex]++;
                } else {
                    colorCounts[hex] = 1;
                }
            }

            console.log('Total unique colors found:', Object.keys(colorCounts).length);

            const sortedColors = Object.entries(colorCounts)
                .sort(function(a, b) { return b[1] - a[1]; });

            console.log('All colors sorted:', sortedColors.length);

            const palette = [];
            const colorDistance = function(c1, c2) {
                const r1 = parseInt(c1.substr(1, 2), 16);
                const g1 = parseInt(c1.substr(3, 2), 16);
                const b1 = parseInt(c1.substr(5, 2), 16);
                const r2 = parseInt(c2.substr(1, 2), 16);
                const g2 = parseInt(c2.substr(3, 2), 16);
                const b2 = parseInt(c2.substr(5, 2), 16);
                return Math.sqrt(
                    Math.pow(r1 - r2, 2) +
                    Math.pow(g1 - g2, 2) +
                    Math.pow(b1 - b2, 2)
                );
            };

            for (let i = 0; i < sortedColors.length; i++) {
                const currentColor = sortedColors[i][0];
                let isSimilar = false;

                for (let j = 0; j < palette.length; j++) {
                    const paletteColor = palette[j][0];
                    if (colorDistance(currentColor, paletteColor) < 30) {
                        isSimilar = true;
                        break;
                    }
                }

                if (!isSimilar) {
                    palette.push(sortedColors[i]);
                }
            }

            console.log('Final palette size:', palette.length);

            return palette.map(function(item) {
                return { hex: item[0], name: item[0] };
            });
        }

        function generateHistogramData() {
            console.log('generateHistogramData called');
            if (!currentImage) {
                console.log('No current image');
                return;
            }
            
            const canvas = document.getElementById('histogram-canvas');
            console.log('Canvas element:', canvas);
            if (!canvas) {
                console.log('Canvas not found');
                return;
            }

            console.log('Canvas dimensions:', canvas.width, 'x', canvas.height);
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            const redData = new Array(256).fill(0);
            const greenData = new Array(256).fill(0);
            const blueData = new Array(256).fill(0);

            const tempCanvas = document.createElement('canvas');
            const tempCtx = tempCanvas.getContext('2d');
            tempCanvas.width = currentImage.width;
            tempCanvas.height = currentImage.height;
            tempCtx.drawImage(currentImage, 0, 0);

            const imageData = tempCtx.getImageData(0, 0, tempCanvas.width, tempCanvas.height);
            const data = imageData.data;

            console.log('Image data length:', data.length);

            for (let i = 0; i < data.length; i += 4) {
                const r = data[i];
                const g = data[i + 1];
                const b = data[i + 2];
                redData[r]++;
                greenData[g]++;
                blueData[b]++;
            }

            const maxCount = Math.max(
                Math.max.apply(null, redData),
                Math.max.apply(null, greenData),
                Math.max.apply(null, blueData)
            );

            console.log('Max count:', maxCount);

            const y = height / 2;
            const barWidth = width / 256;

            ctx.fillStyle = '#333';
            ctx.font = '12px Arial';
            ctx.fillText('Красный', 10, y - 40);
            ctx.fillText('Зеленый', 10, y + 10);
            ctx.fillText('Синий', 10, y + 60);

            for (let i = 0; i < 256; i++) {
                const x = i * barWidth;

                ctx.fillStyle = 'rgb(' + i + ', 0, 0)';
                ctx.fillRect(x, y - 50, barWidth, (redData[i] / maxCount) * 50);

                ctx.fillStyle = 'rgb(0, ' + i + ', 0)';
                ctx.fillRect(x, y, barWidth, (greenData[i] / maxCount) * 50);

                ctx.fillStyle = 'rgb(0, 0, ' + i + ')';
                ctx.fillRect(x, y + 50, barWidth, (blueData[i] / maxCount) * 50);
            }

            console.log('Histogram drawn');
        }

        function downloadCleaned(tool) {
            if (!currentFile || !currentImage) return;

            const canvas = document.createElement('canvas');
            canvas.width = currentImage.width || 800;
            canvas.height = currentImage.height || 600;
            const ctx = canvas.getContext('2d');

            ctx.drawImage(currentImage, 0, 0);

            let suffix = '';
            if (tool === 'remove-exif') {
                suffix = '-cleaned';
            } else if (tool === 'remove-gps') {
                suffix = '-no-gps';
            } else if (tool === 'batch-clean') {
                suffix = '-cleaned';
            }

            const originalName = currentFile.name || 'image';
            const dotIndex = originalName.lastIndexOf('.');
            const name = originalName.substring(0, dotIndex);
            const extension = originalName.substring(dotIndex);
            const newName = name + suffix + '.' + extension;

            const link = document.createElement('a');
            link.download = newName;
            link.href = canvas.toDataURL('image/jpeg', 0.95);
            link.click();

            showSuccessMessage('Изображение успешно загружено!');
        }

        function downloadEdited(tool) {
            if (!currentFile || !currentImage) return;

            const canvas = document.createElement('canvas');
            canvas.width = currentImage.width || 800;
            canvas.height = currentImage.height || 600;
            const ctx = canvas.getContext('2d');

            ctx.drawImage(currentImage, 0, 0);

            if (tool === 'edit-exif') {
                const author = document.getElementById('edit-author') ? document.getElementById('edit-author').value : '';
                const description = document.getElementById('edit-description') ? document.getElementById('edit-description').value : '';
                const software = document.getElementById('edit-software') ? document.getElementById('edit-software').value : '';

                console.log('Edited EXIF:', { author, description, software });
            }

            const originalName = currentFile.name || 'image';
            const dotIndex = originalName.lastIndexOf('.');
            const name = originalName.substring(0, dotIndex);
            const extension = originalName.substring(dotIndex);
            const newName = name + '-edited.' + extension;

            const link = document.createElement('a');
            link.download = newName;
            link.href = canvas.toDataURL('image/jpeg', 0.95);
            link.click();

            showSuccessMessage('Изображение успешно загружено!');
        }

        function showSuccessMessage(message) {
            const existing = document.querySelector('.success-message');
            if (existing) {
                existing.remove();
            }

            const msg = document.createElement('div');
            msg.className = 'success-message';
            msg.innerHTML = '<i class="fas fa-check-circle"></i> ' + message;
            document.body.appendChild(msg);

            setTimeout(function() {
                msg.remove();
            }, 3000);
        }

        init();
    </script>
    </main>
</body>
</html>
