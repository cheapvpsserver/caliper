<!DOCTYPE html>
<html lang="ru-RU">
<head>
<meta charset="UTF-8" />
<title>–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤ –∏–∑ –≤–∏–¥–µ–æ ‚Äì –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤ –∏–∑ –≤–∏–¥–µ–æ—Ñ–∞–π–ª–æ–≤</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –æ–Ω–ª–∞–π–Ω-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–∞–¥—Ä–æ–≤ –∏–∑ –≤–∏–¥–µ–æ—Ñ–∞–π–ª–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ PNG, JPG –∏–ª–∏ WebP">
<!-- Website Icon (Favicon) -->
<link rel="icon" type="image/png" sizes="32x32" href="../../../images/favicon32.png">
<link rel="icon" href="../../../images/favicon32.png" type="image/png">
<!-- Add simple favicon.ico as default -->
<link rel="shortcut icon" href="../../../images/favicon32.png" type="image/x-icon">
<link rel="stylesheet" href="../../../styles.css">
<!-- Include FontAwesome icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
/* Global box model setting, ensure all elements include padding and border when calculating dimensions */
* {
    box-sizing: border-box;
}

/* Ensure body background is consistent with website */
body {
    background-color: #f5f5f5;
    color: #111827;
    font-family: system-ui;
}

/* Add proper padding to main container, ensure content doesn't stick to edges */
main {
    width: 100%;
    overflow-x: hidden;
    overflow-y: auto;
    padding: 30px 0;
}

/* Tool specific styles */
.tool-container {
  max-width: 1000px;
  margin: 0 auto;
  padding: 20px;
  background-color: white;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  overflow: hidden;
}

.tool-container h1 {
  font-size: 28px;
  margin-bottom: 24px;
  color: #111827;
  text-align: center;
}

.tool-container .container {max-width: 100%; margin: auto; overflow: hidden;}
.upload {
  border: 2px dashed #d1d5db;
  padding: 20px;
  text-align: center;
  border-radius: 4px;
  background: white;
  cursor: pointer;
  transition: all 0.2s ease;
  color: #374151;
  margin-bottom: 5px;
  overflow: hidden;
  max-width: 100%;
  box-sizing: border-box;
}

.video-box {
  border: 2px dashed #d1d5db;
  padding: 20px;
  text-align: center;
  border-radius: 4px;
  background: white;
  cursor: pointer;
  transition: all 0.2s ease;
  color: #374151;
  margin-bottom: 0;
  overflow: hidden;
  max-width: 100%;
  box-sizing: border-box;
}

.upload:hover {
  border-color: #3b82f6;
  background-color: #f9fafb;
}

.hidden {display:none;}
video {width:100%;margin-top:10px;border-radius: 4px;}
.controls {margin-top:0;display:grid;gap:10px;}
.controls input, .controls select, .controls button {
  padding: 10px 14px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 14px;
}

.controls button {
  background: #3b82f6;
  color: white;
  border: none;
  cursor: pointer;
  transition: all 0.2s ease;
  width: auto;
  justify-self: center;
  max-width: 100%;
}

.controls button:hover {
  background: #2563eb;
}

/* ‰∏∫ÂÜÖËÅîÊ†∑ÂºèÁöÑÊåâÈíÆÊ∑ªÂä†ÊÇ¨ÂÅúÊïàÊûúÔºå‰ΩøÁî®!importantÁ°Æ‰øù‰ºòÂÖàÁ∫ß */
.controls button:hover {
  background: #2563eb !important;
}

.frames {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(150px,1fr));
  gap:10px;
  margin-top:20px;
}

.frames img {width:100%;display:block;border-radius: 4px;}
.tool-container .section {padding-top:15px;max-width: 100%;overflow: hidden;width: auto !important;position: static !important;left: auto !important;right: auto !important;margin: 5px 0 !important;padding: 5px 0 0 !important;}
.section strong {
  color: #111827;
  font-weight: 600;
}
.inline {display:flex;gap:10px;align-items:center;flex-wrap: wrap;
  max-width: 100%;
  overflow: hidden;
  box-sizing: border-box;
}
.inline > * {
  flex: 1;
  min-width: 0;
  max-width: calc(50% - 5px); /* Âú®ÁßªÂä®Á´ØÊØèË°åÊòæÁ§∫‰∏§‰∏™ÂÖÉÁ¥† */
  box-sizing: border-box;
}

/* ÁßªÂä®Á´ØÊ†∑Âºè‰ºòÂåñ */
@media (max-width: 600px) {
  .inline > * {
    max-width: 100%; /* Âú®Â∞èÂ±èËÆæÂ§á‰∏äÊØèË°åÊòæÁ§∫‰∏Ä‰∏™ÂÖÉÁ¥† */
  }
  
  .preview-container {
    min-width: 100% !important; /* È¢ÑËßàÂÆπÂô®Âú®ÁßªÂä®Á´ØÂç†Êª°ÂÆΩÂ∫¶ */
  }
  
  .tool-container .section {
    flex-direction: column;
  }
  
  .section > div {
    min-width: 100% !important;
    margin-bottom: 10px;
  }
}
/* CTA Section Styles - Tutorial */
.cta-section {
    margin-top: 4rem;
    margin-bottom: 2rem;
    background-color: #0066cc;
    color: white;
    padding: 2rem;
    border-radius: 0.5rem;
}

.cta-content {
    max-width: 1400px;
    margin: 0 auto;
    text-align: center;
}

.cta-content h3 {
    font-size: 2rem;
    font-weight: bold;
    margin-bottom: 1.5rem;
    color: white;
}

.cta-content p {
    font-size: 1.125rem;
    margin-bottom: 2rem;
    line-height: 1.6;
    color: white;
}

.features-row {
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 2rem;
}

@media (min-width: 768px) {
    .features-row {
        flex-direction: row;
    }
}

.feature-item {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 0.5rem;
    padding: 0.75rem 1.5rem;
}

.feature-item .icon {
    font-size: 1.5rem;
}

.cta-features {
    margin-top: 3rem;
}

.cta-features h4 {
    font-size: 1.5rem;
    font-weight: 600;
    margin-bottom: 2rem;
    color: white;
}

.features-grid {
    display: grid;
    grid-template-columns: repeat(1, 1fr);
    gap: 1.5rem;
    max-width: 800px;
    margin: 0 auto;
}

/* Ensure CTA feature list background and text colors are correct */
.cta-section .features-grid {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 0.5rem;
    padding: 1.5rem;
    margin-top: 0.5rem;
}

@media (min-width: 768px) {
    .features-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* Tutorial Step Styles */
.tutorial-step {
    text-align: left;
}

.tutorial-step h5 {
    font-size: 1.25rem !important;
    margin-bottom: 1rem !important;
    color: white !important;
    text-align: center !important;
}

.tutorial-step p {
    margin-bottom: 1rem !important;
    text-align: left !important;
    color: white !important;
}

.tutorial-step ul {
    text-align: left !important;
    margin-left: 2rem !important;
    margin-bottom: 1rem !important;
    color: white !important;
}

.tutorial-step li {
    margin-bottom: 0.5rem !important;
    color: white !important;
}
</style>
<script>  
    document.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        alert('–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é (–ø–æ —â–µ–ª—á–∫—É –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏) –æ—Ç–∫–ª—é—á–µ–Ω–æ');
    });

    document.addEventListener('selectstart', function(e) {
        e.preventDefault();
    });

    document.addEventListener('keydown', function(e) {
        if ((e.ctrlKey || e.metaKey) && (e.key === 'c' || e.key === 'u' || e.key === 's' || e.key === 'a')) {
            e.preventDefault();
            alert('–§—É–Ω–∫—Ü–∏—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞.');
        }
    });

    document.addEventListener('keydown', function(e) {
        if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {
            e.preventDefault();
            alert('–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω—ã.');
        }
    });
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5020583079217470"crossorigin="anonymous"></script> </head>
<body>

<!-- Header will be dynamically loaded by JS -->
<div id="header-container"></div>

<!-- Main content -->
<main class="main">
  <div class="tool-container">
    <h1 class="tool-title">–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤ –∏–∑ –≤–∏–¥–µ–æ</h1>

    <div class="container">

    <div class="upload" id="uploadBox" onclick="document.getElementById('fileInput').click();" style="cursor: pointer;">
      <div style="display: flex; flex-direction: column; align-items: center;">
        <i class="fas fa-cloud-upload-alt" style="font-size: 48px; margin-bottom: 16px; color: #3b82f6;"></i>
        <p>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –≤–∏–¥–µ–æ –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª</p>
        <input type="file" id="fileInput" accept="video/*" style="display: none;">
      </div>
    </div>

    <div class="controls hidden" id="toolBox">
      <!-- Video Preview and Real-time Frame -->
      <div class="section" style="margin-bottom: 20px;">
        <div class="preview-row" style="display: flex; gap: 20px; flex-wrap: wrap; align-items: flex-start; margin-bottom: 20px;">
          <!-- Video Preview (Left) -->
          <div class="preview-container" style="flex: 1; min-width: 250px; display: none;" id="videoPreviewContainer">
            <h4>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –≤–∏–¥–µ–æ</h4>
            <div class="video-box" id="videoBox" style="position: relative;">
              <video id="video" controls style="width: 100%;"></video>
              <!-- Delete video button - Currently located at the top right corner of the video, adjust to one-third position -->
              <button id="deleteVideoBtn" onclick="deleteVideo()" style="position: absolute; top: 30px; right: 20px; background: rgba(239, 68, 68, 0.8); color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 16px; cursor: pointer; z-index: 10;">
                √ó
              </button>
            </div>
          </div>
          
          <!-- Real-time Preview (Right) -->
          <div class="preview-container" style="flex: 1; min-width: 250px; display: none;" id="realTimePreviewContainer">
            <h4>–†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è</h4>
            <div id="realTimePreview" style="border: 2px dashed #d1d5db; border-radius: 4px; padding: 28px 20px; overflow: hidden; background: white; display: flex; justify-content: center; align-items: center;"></div>
          </div>
        </div>
        
        <!-- Video Playback Time - Now spanning full width -->
        <div class="current-time-container" style="text-align: center; margin-top: 10px; margin-bottom: 20px;">
          <strong>–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—èÔºö</strong> <span id="currentTime">00:00:00.000</span>
        </div>
      </div>
      
      <!-- Add media query for mobile responsiveness -->
      <style>
        /* Mobile styles */
        @media (max-width: 768px) {
          .preview-row {
            flex-direction: column;
            align-items: center;
          }
          
          .preview-container {
            min-width: 100% !important;
            width: 100% !important;
          }
          
          /* Ensure video and canvas resize properly on mobile */
          video {
            max-width: 100% !important;
            height: auto !important;
          }
          
          #realTimePreview {
            max-width: 100% !important;
          }
          
          /* On mobile, current time is above controls */
          .current-time-container {
            order: 1;
            margin-bottom: 20px;
          }
        }
        
        /* Desktop styles */
        @media (min-width: 769px) {
          /* On desktop, current time is centered across the full width */
          .current-time-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 10px auto;
            max-width: 1000px;
          }
        }
      </style>

      <!-- Batch and Single Frame Side by Side -->
      <div class="section" style="display: flex; gap: 20px; flex-wrap: wrap;">
        <!-- Batch Frame Extraction (Left) -->
        <div style="flex: 1; min-width: 300px;">
          <h4>–ü–∞–∫–µ—Ç–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤</h4>
          <div class="inline">
            <input id="startTime" placeholder="–í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ (00:10)">
            <input id="endTime" placeholder="–í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è (00:30)">
            <input id="frameCount" type="number" placeholder="–ö–∞–¥—Ä—ã">
          </div>
        </div>
        
        <!-- Single Frame (Right) -->
        <div style="flex: 1; min-width: 300px;">
          <h4>–û–¥–∏–Ω –∫–∞–¥—Ä</h4>
          <div class="inline" style="justify-content: center;">
            <button onclick="step(-0.04)">&lt;</button>
            <button id="playPauseBtn" onclick="togglePlayPause()" style="background: #10b981;margin: 0 10px;">‚ñ∂</button>
            <button onclick="step(0.04)">&gt;</button>
          </div>
        </div>
      </div>

      <!-- Format, Extract, Clear, and Download Buttons -->
      <div class="section" style="display: flex; gap: 10px; align-items: flex-end; flex-wrap: wrap;">
        <!-- Format (Left) -->
        <div style="flex: 1; min-width: 120px;">
          <h4 style="margin: 0 0 5px 0;">–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞</h4>
          <select id="format" style="width: 100%; padding: 10px 14px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 14px; height: 40px; box-sizing: border-box;">
            <option value="image/png">PNG</option>
            <option value="image/jpeg">JPG</option>
            <option value="image/webp">WebP</option>
          </select>
        </div>
        
        <!-- Download ZIP Button -->
        <div style="flex: 1; min-width: 120px;">
          <button onclick="downloadAllAsZip()" style="width: 100%; height: 40px; box-sizing: border-box;">–°–∫–∞—á–∞—Ç—å ZIP</button>
        </div>
        
        <!-- Download All Button -->
        <div style="flex: 1; min-width: 120px;">
          <button onclick="downloadAllIndividually()" style="width: 100%; height: 40px; box-sizing: border-box;">–°–∫–∞—á–∞—Ç—å –≤—Å–µ</button>
        </div>
        
        <!-- Clear Button -->
        <div style="flex: 1; min-width: 120px;">
          <button onclick="clearFrames()" style="width: 100%; height: 40px; box-sizing: border-box;">–û—á–∏—Å—Ç–∏—Ç—å</button>
        </div>
        
        <!-- Extract Frames Button -->
        <div style="flex: 1; min-width: 120px;">
          <button onclick="extract()" style="width: 100%; height: 40px; box-sizing: border-box;">–ò–∑–≤–ª–µ—á—å –∫–∞–¥—Ä—ã</button>
        </div>
      </div>
      
      <!-- Extracted Frames Display Area -->
      <div class="section" id="extractedFramesSection" style="display: none;">
        <h4>–ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ –∫–∞–¥—Ä—ã</h4>
        <div class="frames" id="frames"></div>
      </div>
    </div>

    </div>
  </div>

  <!-- Tutorial Section -->
  <section class="cta-section" id="tutorial">
    <div class="cta-content">
      <h3>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤ –∏–∑ –≤–∏–¥–µ–æ</h3>
      <p>
        –°–ª–µ–¥—É–π—Ç–µ —ç—Ç–∏–º –ø—Ä–æ—Å—Ç—ã–º —à–∞–≥–∞–º, —á—Ç–æ–±—ã –∏–∑–≤–ª–µ–∫–∞—Ç—å –∫–∞–¥—Ä—ã –∏–∑ –≤–∞—à–∏—Ö –≤–∏–¥–µ–æ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö.
      </p>
      
      <div class="features-row">
        <div class="feature-item">
          <span class="icon">üìÅ</span>
          <span>–®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–¥–µ–æ</span>
        </div>
        <div class="feature-item">
          <span class="icon">üëÅÔ∏è</span>
          <span>–®–∞–≥ 2: –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –≤–∏–¥–µ–æ</span>
        </div>
        <div class="feature-item">
          <span class="icon">üéØ</span>
          <span>–®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑–≤–ª–µ—á–µ–Ω–∏—è</span>
        </div>
        <div class="feature-item">
          <span class="icon">üì∏</span>
          <span>–®–∞–≥ 4: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤</span>
        </div>
        <div class="feature-item">
          <span class="icon">üíæ</span>
          <span>–®–∞–≥ 5: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∫–∞–¥—Ä–æ–≤</span>
        </div>
      </div>
      
      <div class="cta-features">
        <h4>–ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ</h4>
        <div class="features-grid" style="display: flex; flex-direction: column; gap: 2rem;">
          <div class="tutorial-step">
            <h5>–®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–¥–µ–æ</h5>
            <p>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –æ–±–ª–∞—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –≤–∏–¥–µ–æ—Ñ–∞–π–ª, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –∏–∑–≤–ª–µ—á–µ–Ω–∏—è. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –≤–∏–¥–µ–æ—Ñ–æ—Ä–º–∞—Ç—ã.</p>
          </div>
          
          <div class="tutorial-step">
            <h5>–®–∞–≥ 2: –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –≤–∏–¥–µ–æ</h5>
            <p>–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—ã —É–≤–∏–¥–∏—Ç–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –≤–∏–¥–µ–æ —Å–ª–µ–≤–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞–¥—Ä–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å–ø—Ä–∞–≤–∞. –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è (–≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö) –ø–æ–∫–∞–∑–∞–Ω–æ –ø–æ–¥ –≤–∏–¥–µ–æ.</p>
          </div>
          
          <div class="tutorial-step">
            <h5>–®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑–≤–ª–µ—á–µ–Ω–∏—è</h5>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–Ω—ã–º –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º –∫–∞–¥—Ä–æ–≤ (–¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–∞–¥—Ä–æ–≤ —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏) –∏–ª–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º –æ–¥–Ω–æ–≥–æ –∫–∞–¥—Ä–∞ (–¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤). –í—ã–±–µ—Ä–∏—Ç–µ –∂–µ–ª–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ (PNG, JPG –∏–ª–∏ WebP).</p>
          </div>
          
          <div class="tutorial-step">
            <h5>–®–∞–≥ 4: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤</h5>
            <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É "–ò–∑–≤–ª–µ—á—å –∫–∞–¥—Ä—ã", —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –∏–∑–≤–ª–µ—á–µ–Ω–∏—è. –î–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–∞–¥—Ä–æ–≤ –≤—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–º–µ—â–∞—Ç—å—Å—è –ø–æ –≤–∏–¥–µ–æ —Å –ø–æ–º–æ—â—å—é —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ–º –∏ –∏–∑–≤–ª–µ–∫–∞—Ç—å –∫–∞–¥—Ä—ã –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç.</p>
          </div>
          
          <div class="tutorial-step">
            <h5>–®–∞–≥ 5: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∫–∞–¥—Ä–æ–≤</h5>
            <p>–ü–æ—Å–ª–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –≤–∞—à–∏ –∫–∞–¥—Ä—ã –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã –≤ –≥–∞–ª–µ—Ä–µ–µ. –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–∞–¥—Ä—ã –∏–ª–∏ –≤—Å–µ –∫–∞–¥—Ä—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∑–∞–≥—Ä—É–∑–∫–∏.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Related Tools Section -->
  <section class="section related-tools">
    <div class="container">
      <h2 class="section-title">–°–≤—è–∑–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h2>
      <div class="tools-grid" id="relatedTools">
        <!-- Related tools will be dynamically generated by JS -->
      </div>
    </div>
  </section>
</main>

<!-- Footer will be dynamically loaded by JS -->
<div id="footer-container"></div>

<script>
const video = document.getElementById('video');
const canvas = document.createElement('canvas');
const ctx = canvas.getContext('2d');
const framesBox = document.getElementById('frames');
const realTimePreview = document.getElementById('realTimePreview');
const extractedFramesSection = document.getElementById('extractedFramesSection');
const currentTimeElement = document.getElementById('currentTime');
let realTimeFrameCanvas = null;
let realTimeFrameCtx = null;
let animationId = null;

document.getElementById('fileInput').onchange = e => {
  video.src = URL.createObjectURL(e.target.files[0]);
  document.getElementById('uploadBox').classList.add('hidden');
  document.getElementById('videoBox').classList.remove('hidden');
  document.getElementById('toolBox').classList.remove('hidden');
  
  // Show video preview and real-time preview containers
  document.getElementById('videoPreviewContainer').style.display = 'block';
  document.getElementById('realTimePreviewContainer').style.display = 'block';
  
  // Initialize real-time frame display
  initRealTimeFrame();
};

// Update video playback time to milliseconds
video.addEventListener('timeupdate', () => {
  const time = video.currentTime;
  const hours = Math.floor(time / 3600);
  const minutes = Math.floor((time % 3600) / 60);
  const seconds = Math.floor(time % 60);
  const milliseconds = Math.floor((time % 1) * 1000);
  
  currentTimeElement.textContent = 
    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}.${milliseconds.toString().padStart(3, '0')}`;
});

// Initialize real-time frame display
function initRealTimeFrame() {
  // Remove old real-time frame canvas
  if (realTimeFrameCanvas) {
    realTimeFrameCanvas.remove();
  }
  
  // Create new real-time frame canvas
  realTimeFrameCanvas = document.createElement('canvas');
  realTimeFrameCtx = realTimeFrameCanvas.getContext('2d');
  realTimeFrameCanvas.style.width = '100%';
  realTimeFrameCanvas.style.height = '100%';
  realTimeFrameCanvas.style.display = 'block';
  realTimeFrameCanvas.style.borderRadius = '4px'; // Add rounded corner style, consistent with the video on the left
  realTimeFrameCanvas.style.overflow = 'hidden';
  
  // Add to real-time preview area
  realTimePreview.innerHTML = '';
  realTimePreview.appendChild(realTimeFrameCanvas);
  
  // Start real-time capture
  startRealTimeCapture();
}

// Update canvas size to ensure it matches video size exactly
function updateCanvasSize() {
  if (realTimeFrameCanvas) {
    // Ensure Canvas's actual pixel size matches the video exactly
    realTimeFrameCanvas.width = video.videoWidth;
    realTimeFrameCanvas.height = video.videoHeight;
    
    // Get the actual display size of the video element on the left (excluding padding and border)
    const videoElement = document.getElementById('video');
    const videoRect = videoElement.getBoundingClientRect();
    
    // Directly set the display size of the real-time frame Canvas to be the same as the video on the left
    // Do not consider container padding, ensure the image size is consistent
    realTimeFrameCanvas.style.width = `${videoRect.width}px`;
    realTimeFrameCanvas.style.height = `${videoRect.height}px`;
    realTimeFrameCanvas.style.display = 'block';
    realTimeFrameCanvas.style.margin = '0 auto';
    
    // Ensure the width of the right-side preview container is the same as the left 
    const leftContainer = videoElement.closest('.preview-container');
    const rightContainer = realTimePreview.closest('.preview-container');
    if (leftContainer && rightContainer) {
      const leftWidth = leftContainer.getBoundingClientRect().width;
      rightContainer.style.width = `${leftWidth}px`;
    }
  }
  
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;
}

// Add window size change and video size change listeners
window.addEventListener('resize', updateCanvasSize);
video.addEventListener('loadedmetadata', updateCanvasSize);
video.addEventListener('loadeddata', updateCanvasSize);
video.addEventListener('resize', updateCanvasSize);

// Start real-time capture
function startRealTimeCapture() {
  if (animationId) return;
  
  function captureFrame() {
    if (realTimeFrameCtx) {
      realTimeFrameCtx.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);
    }
    animationId = requestAnimationFrame(captureFrame);
  }
  
  captureFrame();
}

// Listen for video time changes, ensure real-time preview updates
video.addEventListener('timeupdate', () => {
  if (realTimeFrameCtx) {
    realTimeFrameCtx.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);
  }
});

// Listen for video seek complete event
video.addEventListener('seeked', () => {
  if (realTimeFrameCtx) {
    realTimeFrameCtx.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);
  }
});

// Listen for window size changes, update real-time frame size
window.addEventListener('resize', updateCanvasSize);

// Stop real-time capture
function stopRealTimeCapture() {
  if (animationId) {
    cancelAnimationFrame(animationId);
    animationId = null;
  }
}

// Listen for video play and pause events
video.addEventListener('play', startRealTimeCapture);
video.addEventListener('pause', stopRealTimeCapture);
video.addEventListener('ended', stopRealTimeCapture);

function parseTime(t){
  if(!t) return 0;
  if(t.includes(':')){
    const p=t.split(':').map(Number);
    return p.length===3?p[0]*3600+p[1]*60+p[2]:p[0]*60+p[1];
  }
  return parseFloat(t);
}

function step(v){
  video.currentTime=Math.max(0,video.currentTime+v);
  // Ensure the right-side real-time preview updates immediately
  if (realTimeFrameCtx) {
    realTimeFrameCtx.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);
  }
}

// Toggle play and pause state
function togglePlayPause() {
  const playPauseBtn = document.getElementById('playPauseBtn');
  if (video.paused || video.ended) {
    video.play();
    playPauseBtn.textContent = '‚è∏';
  } else {
    video.pause();
    playPauseBtn.textContent = '‚ñ∂';
  }
}

// Listen for video play state changes, update button text
video.addEventListener('play', () => {
  const playPauseBtn = document.getElementById('playPauseBtn');
  if (playPauseBtn) {
    playPauseBtn.textContent = '‚è∏';
  }
});

video.addEventListener('pause', () => {
  const playPauseBtn = document.getElementById('playPauseBtn');
  if (playPauseBtn) {
    playPauseBtn.textContent = '‚ñ∂';
  }
});

video.addEventListener('ended', () => {
  const playPauseBtn = document.getElementById('playPauseBtn');
  if (playPauseBtn) {
    playPauseBtn.textContent = '‚ñ∂';
  }
});

// Delete video and return to upload module
function deleteVideo() {
  // Stop video playback
  video.pause();
  video.src = '';
  
  // Clear real-time frame
  if (realTimeFrameCanvas) {
    realTimeFrameCanvas.remove();
    realTimeFrameCanvas = null;
    realTimeFrameCtx = null;
  }
  
  // Clear extracted frames
  framesBox.innerHTML = '';
  extractedFramesSection.style.display = 'none';
  
  // Reset time display
  currentTimeElement.textContent = '00:00:00.000';
  
  // Hide video preview and real-time preview containers
  document.getElementById('videoPreviewContainer').style.display = 'none';
  document.getElementById('realTimePreviewContainer').style.display = 'none';
  
  // Hide tool area, show upload area
  document.getElementById('toolBox').classList.add('hidden');
  document.getElementById('videoBox').classList.add('hidden');
  document.getElementById('uploadBox').classList.remove('hidden');
  
  // Reset fileInput's value to solve the issue of not being able to upload the same video again
  document.getElementById('fileInput').value = '';
  
  // Stop real-time capture
  stopRealTimeCapture();
  
  // Reset play button state
  const playPauseBtn = document.getElementById('playPauseBtn');
  if (playPauseBtn) {
    playPauseBtn.textContent = '‚ñ∂';
  }
}

// Clear all extracted frames
function clearFrames() {
  // Clear all extracted frames
  framesBox.innerHTML = '';
  // Hide the extracted frames area
  extractedFramesSection.style.display = 'none';
}

// Download all extracted frames individually
function downloadAllIndividually() {
  const images = framesBox.querySelectorAll('img');
  if (images.length === 0) {
    alert('No frames to download!');
    return;
  }
  
  const formatInput = document.getElementById('format');
  const format = formatInput.value;
  const extension = format === 'image/png' ? 'png' : format === 'image/jpeg' ? 'jpg' : 'webp';
  
  images.forEach((img, index) => {
    const a = document.createElement('a');
    a.href = img.src;
    a.download = `frame_${index + 1}.${extension}`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  });
}

// Download single frame
function downloadFrame(imgElement) {
  const a = document.createElement('a');
  a.href = imgElement.src;
  
  const formatInput = document.getElementById('format');
  const format = formatInput.value;
  const extension = format === 'image/png' ? 'png' : format === 'image/jpeg' ? 'jpg' : 'webp';
  
  a.download = `frame_${Date.now()}.${extension}`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}

// Delete single frame
function deleteFrame(imgElement) {
  imgElement.closest('.frame-item').remove();
  
  // If there are no remaining frames, hide the extracted frames area
  if (framesBox.querySelectorAll('.frame-item').length === 0) {
    extractedFramesSection.style.display = 'none';
  }
}

// ZIP download functionality (Note: requires JSZip library, basic implementation provided)
function downloadAllAsZip() {
  const images = framesBox.querySelectorAll('img');
  if (images.length === 0) {
    alert('No frames to download!');
    return;
  }
  
  alert('ZIP download functionality requires JSZip library. Please download frames individually for now.');
  // In actual projects, JSZip library can be used here to create and download ZIP files
}

function capture(time, format='image/png'){
  return new Promise(res=>{
    video.currentTime=time;
    video.onseeked=()=>{
      canvas.width=video.videoWidth;
      canvas.height=video.videoHeight;
      ctx.drawImage(video,0,0);
      res(canvas.toDataURL(format));
    };
  });
}

async function extract(){
  const startTimeInput = document.getElementById('startTime');
  const endTimeInput = document.getElementById('endTime');
  const frameCountInput = document.getElementById('frameCount');
  const formatInput = document.getElementById('format');
  
  const start=parseTime(startTimeInput.value);
  const end=parseTime(endTimeInput.value);
  const count=parseInt(frameCountInput.value);
  const format=formatInput.value;

  let times=[];
  if(start && end && count){
    const step=(end-start)/(count-1);
    for(let i=0;i<count;i++) times.push(start+i*step);
  } else {
    // If no batch settings, use current video time
    times=[video.currentTime];
  }

  for(const t of times){
    const url=await capture(t, format);
    
    // Create frame container with delete and download icons
    const frameItem = document.createElement('div');
    frameItem.className = 'frame-item';
    frameItem.style = 'position: relative; display: inline-block; margin: 5px;';
    
    // Create screenshot image
    const img=document.createElement('img');
    img.src=url;
    img.style = 'width: 100%; display: block; border-radius: 4px;';
    
    // Create icon container
    const iconsContainer = document.createElement('div');
    iconsContainer.style = 'position: absolute; top: 5px; right: 5px; display: flex; gap: 5px;';
    
    // Create delete icon
    const deleteIcon = document.createElement('button');
    deleteIcon.innerHTML = '<i class="fas fa-trash"></i>';
    deleteIcon.style = 'background: #ef4444; color: white; border: none; border-radius: 4px; padding: 4px; font-size: 12px; cursor: pointer; z-index: 10;';
    deleteIcon.onclick = () => deleteFrame(img);
    
    // Create download icon
    const downloadIcon = document.createElement('button');
    downloadIcon.innerHTML = '<i class="fas fa-download"></i>';
    downloadIcon.style = 'background: #3b82f6; color: white; border: none; border-radius: 4px; padding: 4px; font-size: 12px; cursor: pointer; z-index: 10;';
    downloadIcon.onclick = () => downloadFrame(img);
    
    // Assemble elements
    iconsContainer.appendChild(deleteIcon);
    iconsContainer.appendChild(downloadIcon);
    frameItem.appendChild(img);
    frameItem.appendChild(iconsContainer);
    
    framesBox.appendChild(frameItem);
  }
  
  // If there are extracted frames, show the extracted frames area
  if (framesBox.children.length > 0) {
    extractedFramesSection.style.display = 'block';
  }
}
</script>

    <!-- Include the main script file for language switcher and other functionality -->
    <script src="../../scripts/script.js"></script>

<!-- Include the related tools script -->
<script src="../../scripts/script-related-tools.js"></script>

<!-- Initialize related tools with current tool slug -->
<script>
    // Call the related tools function with the current tool's slug
    initRelatedTools("video-frame-extractor");
</script>

</body>
</html>
