<!DOCTYPE html>
<html lang="ur-PK">
<head>
<meta charset="UTF-8" />
<title>ÙˆÛŒÚˆÛŒÙˆ ÙØ±ÛŒÙ… Ø§ÛŒÚ©Ø³Ù¹Ø±ÛŒÚ©Ù¹Ø± â€“ ÙˆÛŒÚˆÛŒÙˆ ÙØ§Ø¦Ù„Ø² Ø³Û’ ÙØ±ÛŒÙ… Ù†Ú©Ø§Ù„ÛŒÚº</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="ÙˆÛŒÚˆÛŒÙˆ ÙØ§Ø¦Ù„Ø² Ø³Û’ PNGØŒ JPGØŒ ÛŒØ§ WebP ÙØ§Ø±Ù…ÛŒÙ¹ Ù…ÛŒÚº ÙØ±ÛŒÙ… Ù†Ú©Ø§Ù„Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ Ù…ÙØª Ø¢Ù† Ù„Ø§Ø¦Ù† ÙˆÛŒÚˆÛŒÙˆ ÙØ±ÛŒÙ… Ø§ÛŒÚ©Ø³Ù¹Ø±ÛŒÚ©Ù¹Ø± Ù¹ÙˆÙ„">
<!-- Website Icon (Favicon) -->
<link rel="icon" type="image/png" sizes="32x32" href="../../../images/favicon32.png">
<link rel="icon" href="../../../images/favicon32.png" type="image/png">
<!-- Add simple favicon.ico as default -->
<link rel="shortcut icon" href="../../../images/favicon32.png" type="image/x-icon">
<link rel="stylesheet" href="../../../styles.css">
<!-- Include FontAwesome icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
/* Global box model setting, ensure all elements include padding and border when calculating dimensions */
* {
    box-sizing: border-box;
}

/* Ensure body background is consistent with website */
body {
    background-color: #f5f5f5;
    color: #111827;
    font-family: system-ui;
}

/* Add proper padding to main container, ensure content doesn't stick to edges */
main {
    width: 100%;
    overflow-x: hidden;
    overflow-y: auto;
    padding: 30px 0;
}

/* Tool specific styles */
.tool-container {
  max-width: 1000px;
  margin: 0 auto;
  padding: 20px;
  background-color: white;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  overflow: hidden;
}

.tool-container h1 {
  font-size: 28px;
  margin-bottom: 24px;
  color: #111827;
  text-align: center;
}

.tool-container .container {max-width: 100%; margin: auto; overflow: hidden;}
.upload {
  border: 2px dashed #d1d5db;
  padding: 20px;
  text-align: center;
  border-radius: 4px;
  background: white;
  cursor: pointer;
  transition: all 0.2s ease;
  color: #374151;
  margin-bottom: 5px;
  overflow: hidden;
  max-width: 100%;
  box-sizing: border-box;
}

.video-box {
  border: 2px dashed #d1d5db;
  padding: 20px;
  text-align: center;
  border-radius: 4px;
  background: white;
  cursor: pointer;
  transition: all 0.2s ease;
  color: #374151;
  margin-bottom: 0;
  overflow: hidden;
  max-width: 100%;
  box-sizing: border-box;
}

.upload:hover {
  border-color: #3b82f6;
  background-color: #f9fafb;
}

.hidden {display:none;}
video {width:100%;margin-top:10px;border-radius: 4px;}
.controls {margin-top:0;display:grid;gap:10px;}
.controls input, .controls select, .controls button {
  padding: 10px 14px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 14px;
}

.controls button {
  background: #3b82f6;
  color: white;
  border: none;
  cursor: pointer;
  transition: all 0.2s ease;
  width: auto;
  justify-self: center;
  max-width: 100%;
}

.controls button:hover {
  background: #2563eb;
}

/* ä¸ºå†…è”æ ·å¼çš„æŒ‰é’®æ·»åŠ æ‚¬åœæ•ˆæœï¼Œä½¿ç”¨!importantç¡®ä¿ä¼˜å…ˆçº§ */
.controls button:hover {
  background: #2563eb !important;
}

.frames {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(150px,1fr));
  gap:10px;
  margin-top:20px;
}

.frames img {width:100%;display:block;border-radius: 4px;}
.tool-container .section {padding-top:15px;max-width: 100%;overflow: hidden;width: auto !important;position: static !important;left: auto !important;right: auto !important;margin: 5px 0 !important;padding: 5px 0 0 !important;}
.section strong {
  color: #111827;
  font-weight: 600;
}
.inline {display:flex;gap:10px;align-items:center;flex-wrap: wrap;
  max-width: 100%;
  overflow: hidden;
  box-sizing: border-box;
}
.inline > * {
  flex: 1;
  min-width: 0;
  max-width: calc(50% - 5px); /* åœ¨ç§»åŠ¨ç«¯æ¯è¡Œæ˜¾ç¤ºä¸¤ä¸ªå…ƒç´  */
  box-sizing: border-box;
}

/* ç§»åŠ¨ç«¯æ ·å¼ä¼˜åŒ– */
@media (max-width: 600px) {
  .inline > * {
    max-width: 100%; /* åœ¨å°å±è®¾å¤‡ä¸Šæ¯è¡Œæ˜¾ç¤ºä¸€ä¸ªå…ƒç´  */
  }
  
  .preview-container {
    min-width: 100% !important; /* é¢„è§ˆå®¹å™¨åœ¨ç§»åŠ¨ç«¯å æ»¡å®½åº¦ */
  }
  
  .tool-container .section {
    flex-direction: column;
  }
  
  .section > div {
    min-width: 100% !important;
    margin-bottom: 10px;
  }
}
/* CTA Section Styles - Tutorial */
.cta-section {
    margin-top: 4rem;
    margin-bottom: 2rem;
    background-color: #0066cc;
    color: white;
    padding: 2rem;
    border-radius: 0.5rem;
}

.cta-content {
    max-width: 1400px;
    margin: 0 auto;
    text-align: center;
}

.cta-content h3 {
    font-size: 2rem;
    font-weight: bold;
    margin-bottom: 1.5rem;
    color: white;
}

.cta-content p {
    font-size: 1.125rem;
    margin-bottom: 2rem;
    line-height: 1.6;
    color: white;
}

.features-row {
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 2rem;
}

@media (min-width: 768px) {
    .features-row {
        flex-direction: row;
    }
}

.feature-item {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 0.5rem;
    padding: 0.75rem 1.5rem;
}

.feature-item .icon {
    font-size: 1.5rem;
}

.cta-features {
    margin-top: 3rem;
}

.cta-features h4 {
    font-size: 1.5rem;
    font-weight: 600;
    margin-bottom: 2rem;
    color: white;
}

.features-grid {
    display: grid;
    grid-template-columns: repeat(1, 1fr);
    gap: 1.5rem;
    max-width: 800px;
    margin: 0 auto;
}

/* Ensure CTA feature list background and text colors are correct */
.cta-section .features-grid {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 0.5rem;
    padding: 1.5rem;
    margin-top: 0.5rem;
}

@media (min-width: 768px) {
    .features-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* Tutorial Step Styles */
.tutorial-step {
    text-align: left;
}

.tutorial-step h5 {
    font-size: 1.25rem !important;
    margin-bottom: 1rem !important;
    color: white !important;
    text-align: center !important;
}

.tutorial-step p {
    margin-bottom: 1rem !important;
    text-align: left !important;
    color: white !important;
}

.tutorial-step ul {
    text-align: left !important;
    margin-left: 2rem !important;
    margin-bottom: 1rem !important;
    color: white !important;
}

.tutorial-step li {
    margin-bottom: 0.5rem !important;
    color: white !important;
}
</style>
<script>  
    document.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        alert('Ø¯Ø§Ø¦ÛŒÚº Ú©Ù„Ú© Ú©Ø§ Ù…ÛŒÙ†Ùˆ ØºÛŒØ± ÙØ¹Ø§Ù„ ÛÛ’Û”');
    });

    document.addEventListener('selectstart', function(e) {
        e.preventDefault();
    });

    document.addEventListener('keydown', function(e) {
        if ((e.ctrlKey || e.metaKey) && (e.key === 'c' || e.key === 'u' || e.key === 's' || e.key === 'a')) {
            e.preventDefault();
            alert('Ú©Ø§Ù¾ÛŒ ÙÙ†Ú©Ø´Ù† ØºÛŒØ± ÙØ¹Ø§Ù„ ÛÛ’Û”');
        }
    });

    document.addEventListener('keydown', function(e) {
        if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {
            e.preventDefault();
            alert('ÚˆÙˆÛŒÙ„Ù¾Ø± Ù¹ÙˆÙ„Ø² ØºÛŒØ± ÙØ¹Ø§Ù„ ÛÛŒÚºÛ”');
        }
    });
</script>
</head>
<body>

<!-- Header will be dynamically loaded by JS -->
<div id="header-container"></div>

<!-- Main content -->
<main class="main">
  <div class="tool-container">
    <h1 class="tool-title">ÙˆÛŒÚˆÛŒÙˆ ÙØ±ÛŒÙ… Ø§ÛŒÚ©Ø³Ù¹Ø±ÛŒÚ©Ù¹Ø±</h1>

    <div class="container">

    <div class="upload" id="uploadBox" onclick="document.getElementById('fileInput').click();" style="cursor: pointer;">
      <div style="display: flex; flex-direction: column; align-items: center;">
        <i class="fas fa-cloud-upload-alt" style="font-size: 48px; margin-bottom: 16px; color: #3b82f6;"></i>
        <p>ÙˆÛŒÚˆÛŒÙˆ ÚˆØ±Ø§Ú¯ Ø§ÙˆØ± ÚˆØ±Ø§Ù¾ Ú©Ø±ÛŒÚº ÛŒØ§ ÙØ§Ø¦Ù„ Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº</p>
        <input type="file" id="fileInput" accept="video/*" style="display: none;">
      </div>
    </div>

    <div class="controls hidden" id="toolBox">
      <!-- Video Preview and Real-time Frame -->
      <div class="section" style="margin-bottom: 20px;">
        <div class="preview-row" style="display: flex; gap: 20px; flex-wrap: wrap; align-items: flex-start; margin-bottom: 20px;">
          <!-- Video Preview (Left) -->
          <div class="preview-container" style="flex: 1; min-width: 250px; display: none;" id="videoPreviewContainer">
            <h4>ÙˆÛŒÚˆÛŒÙˆ Ù¾ÛŒØ´ Ù†Ø¸Ø§Ø±Û</h4>
            <div class="video-box" id="videoBox" style="position: relative;">
              <video id="video" controls style="width: 100%;"></video>
              <!-- Delete video button - Currently located at the top right corner of the video, adjust to one-third position -->
              <button id="deleteVideoBtn" onclick="deleteVideo()" style="position: absolute; top: 30px; right: 20px; background: rgba(239, 68, 68, 0.8); color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 16px; cursor: pointer; z-index: 10;">
                Ã—
              </button>
            </div>
          </div>
          
          <!-- Real-time Preview (Right) -->
          <div class="preview-container" style="flex: 1; min-width: 250px; display: none;" id="realTimePreviewContainer">
            <h4>Ø±ÛŒÙ„ Ù¹Ø§Ø¦Ù… ÙØ±ÛŒÙ…</h4>
            <div id="realTimePreview" style="border: 2px dashed #d1d5db; border-radius: 4px; padding: 28px 20px; overflow: hidden; background: white; display: flex; justify-content: center; align-items: center;"></div>
          </div>
        </div>
        
        <!-- Video Playback Time - Now spanning full width -->
        <div class="current-time-container" style="text-align: center; margin-top: 10px; margin-bottom: 20px;">
          <strong>Ù…ÙˆØ¬ÙˆØ¯Û ÙˆÙ‚Øªï¼š</strong> <span id="currentTime">00:00:00.000</span>
        </div>
      </div>
      
      <!-- Add media query for mobile responsiveness -->
      <style>
        /* Mobile styles */
        @media (max-width: 768px) {
          .preview-row {
            flex-direction: column;
            align-items: center;
          }
          
          .preview-container {
            min-width: 100% !important;
            width: 100% !important;
          }
          
          /* Ensure video and canvas resize properly on mobile */
          video {
            max-width: 100% !important;
            height: auto !important;
          }
          
          #realTimePreview {
            max-width: 100% !important;
          }
          
          /* On mobile, current time is above controls */
          .current-time-container {
            order: 1;
            margin-bottom: 20px;
          }
        }
        
        /* Desktop styles */
        @media (min-width: 769px) {
          /* On desktop, current time is centered across the full width */
          .current-time-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 10px auto;
            max-width: 1000px;
          }
        }
      </style>

      <!-- Batch and Single Frame Side by Side -->
      <div class="section" style="display: flex; gap: 20px; flex-wrap: wrap;">
        <!-- Batch Frame Extraction (Left) -->
        <div style="flex: 1; min-width: 300px;">
          <h4>Ø¨ÛŒÚ† ÙØ±ÛŒÙ… Ø§ÛŒÚ©Ø³Ù¹Ø±ÛŒÚ©Ø´Ù†</h4>
          <div class="inline">
            <input id="startTime" placeholder="Ø´Ø±ÙˆØ¹ Ú©Ø§ ÙˆÙ‚Øª (00:10)">
            <input id="endTime" placeholder="Ø§Ø®ØªØªØ§Ù… Ú©Ø§ ÙˆÙ‚Øª (00:30)">
            <input id="frameCount" type="number" placeholder="ÙØ±ÛŒÙ…">
          </div>
        </div>
        
        <!-- Single Frame (Right) -->
        <div style="flex: 1; min-width: 300px;">
          <h4>Ø³Ù†Ú¯Ù„ ÙØ±ÛŒÙ…</h4>
          <div class="inline" style="justify-content: center;">
            <button onclick="step(-0.04)">&lt;</button>
            <button id="playPauseBtn" onclick="togglePlayPause()" style="background: #10b981;margin: 0 10px;">â–¶</button>
            <button onclick="step(0.04)">&gt;</button>
          </div>
        </div>
      </div>

      <!-- Format, Extract, Clear, and Download Buttons -->
      <div class="section" style="display: flex; gap: 10px; align-items: flex-end; flex-wrap: wrap;">
        <!-- Format (Left) -->
        <div style="flex: 1; min-width: 120px;">
          <h4 style="margin: 0 0 5px 0;">Ø¢Ø¤Ù¹ Ù¾Ù¹ ÙØ§Ø±Ù…ÛŒÙ¹</h4>
          <select id="format" style="width: 100%; padding: 10px 14px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 14px; height: 40px; box-sizing: border-box;">
            <option value="image/png">PNG</option>
            <option value="image/jpeg">JPG</option>
            <option value="image/webp">WebP</option>
          </select>
        </div>
        
        <!-- Download ZIP Button -->
        <div style="flex: 1; min-width: 120px;">
          <button onclick="downloadAllAsZip()" style="width: 100%; height: 40px; box-sizing: border-box;">Ø²ÙÙ¾ ÚˆØ§Ø¤Ù† Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº</button>
        </div>
        
        <!-- Download All Button -->
        <div style="flex: 1; min-width: 120px;">
          <button onclick="downloadAllIndividually()" style="width: 100%; height: 40px; box-sizing: border-box;">ØªÙ…Ø§Ù… ÚˆØ§Ø¤Ù† Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº</button>
        </div>
        
        <!-- Clear Button -->
        <div style="flex: 1; min-width: 120px;">
          <button onclick="clearFrames()" style="width: 100%; height: 40px; box-sizing: border-box;">ØµØ§Ù Ú©Ø±ÛŒÚº</button>
        </div>
        
        <!-- Extract Frames Button -->
        <div style="flex: 1; min-width: 120px;">
          <button onclick="extract()" style="width: 100%; height: 40px; box-sizing: border-box;">ÙØ±ÛŒÙ… Ù†Ú©Ø§Ù„ÛŒÚº</button>
        </div>
      </div>
      
      <!-- Extracted Frames Display Area -->
      <div class="section" id="extractedFramesSection" style="display: none;">
        <h4>Ù†Ú©Ø§Ù„Û’ Ú¯Ø¦Û’ ÙØ±ÛŒÙ…</h4>
        <div class="frames" id="frames"></div>
      </div>
    </div>

    </div>
  </div>

  <!-- Tutorial Section -->
  <section class="cta-section" id="tutorial">
    <div class="cta-content">
      <h3>ÙˆÛŒÚˆÛŒÙˆ ÙØ±ÛŒÙ… Ø§ÛŒÚ©Ø³Ù¹Ø±ÛŒÚ©Ù¹Ø± Ú©Ø§ Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©ÛŒØ³Û’ Ú©Ø±ÛŒÚº</h3>
      <p>
        Ù…Ø®ØªÙ„Ù ÙØ§Ø±Ù…ÛŒÙ¹Ø³ Ù…ÛŒÚº Ø§Ù¾Ù†ÛŒ ÙˆÛŒÚˆÛŒÙˆØ² Ø³Û’ ÙØ±ÛŒÙ… Ù†Ú©Ø§Ù„Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ Ø§Ù† Ø³Ø§Ø¯Û Ø§Ù‚Ø¯Ø§Ù…Ø§Øª Ù¾Ø± Ø¹Ù…Ù„ Ú©Ø±ÛŒÚºÛ”
      </p>
      
      <div class="features-row">
        <div class="feature-item">
          <span class="icon">ğŸ“</span>
          <span>Ù…Ø±Ø­Ù„Û 1: ÙˆÛŒÚˆÛŒÙˆ Ø§Ù¾ Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº</span>
        </div>
        <div class="feature-item">
          <span class="icon">ğŸ‘ï¸</span>
          <span>Ù…Ø±Ø­Ù„Û 2: ÙˆÛŒÚˆÛŒÙˆ Ú©Ø§ Ø¬Ø§Ø¦Ø²Û Ù„ÛŒÚº</span>
        </div>
        <div class="feature-item">
          <span class="icon">ğŸ¯</span>
          <span>Ù…Ø±Ø­Ù„Û 3: Ø§ÛŒÚ©Ø³Ù¹Ø±ÛŒÚ©Ø´Ù† Ø¢Ù¾Ø´Ù†Ø² Ø³ÛŒÙ¹ Ú©Ø±ÛŒÚº</span>
        </div>
        <div class="feature-item">
          <span class="icon">ğŸ“¸</span>
          <span>Ù…Ø±Ø­Ù„Û 4: ÙØ±ÛŒÙ… Ù†Ú©Ø§Ù„ÛŒÚº</span>
        </div>
        <div class="feature-item">
          <span class="icon">ğŸ’¾</span>
          <span>Ù…Ø±Ø­Ù„Û 5: ÙØ±ÛŒÙ… ÚˆØ§Ø¤Ù† Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº</span>
        </div>
      </div>
      
      <div class="cta-features">
        <h4>Ù…Ø±Ø­Ù„Û ÙˆØ§Ø± Ø³Ø¨Ù‚</h4>
        <div class="features-grid" style="display: flex; flex-direction: column; gap: 2rem;">
          <div class="tutorial-step">
            <h5>Ù…Ø±Ø­Ù„Û 1: ÙˆÛŒÚˆÛŒÙˆ Ø§Ù¾ Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº</h5>
            <p>Ø§ÛŒÚ©Ø³Ù¹Ø±ÛŒÚ©Ø´Ù† Ú©Ø§ Ø¹Ù…Ù„ Ø´Ø±ÙˆØ¹ Ú©Ø±Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ Ø§Ù¾ Ù„ÙˆÚˆ Ø¹Ù„Ø§Ù‚Û’ Ù¾Ø± Ú©Ù„Ú© Ú©Ø±ÛŒÚº ÛŒØ§ Ø§Ù¾Ù†ÛŒ ÙˆÛŒÚˆÛŒÙˆ ÙØ§Ø¦Ù„ Ú©Ùˆ ÚˆØ±Ø§Ú¯ Ø§ÙˆØ± ÚˆØ±Ø§Ù¾ Ú©Ø±ÛŒÚºÛ” ÛŒÛ Ù¹ÙˆÙ„ ØªÙ…Ø§Ù… Ø¨Ú‘Û’ ÙˆÛŒÚˆÛŒÙˆ ÙØ§Ø±Ù…ÛŒÙ¹Ø³ Ú©ÛŒ Ø­Ù…Ø§ÛŒØª Ú©Ø±ØªØ§ ÛÛ’Û”</p>
          </div>
          
          <div class="tutorial-step">
            <h5>Ù…Ø±Ø­Ù„Û 2: ÙˆÛŒÚˆÛŒÙˆ Ú©Ø§ Ø¬Ø§Ø¦Ø²Û Ù„ÛŒÚº</h5>
            <p>Ø§Ù¾ Ù„ÙˆÚˆ ÛÙˆÙ†Û’ Ú©Û’ Ø¨Ø¹Ø¯ØŒ Ø¢Ù¾ Ø¨Ø§Ø¦ÛŒÚº Ø¬Ø§Ù†Ø¨ ÙˆÛŒÚˆÛŒÙˆ Ú©Ø§ Ø¬Ø§Ø¦Ø²Û Ø§ÙˆØ± Ø¯Ø§Ø¦ÛŒÚº Ø¬Ø§Ù†Ø¨ Ø±ÛŒÙ„ Ù¹Ø§Ø¦Ù… ÙØ±ÛŒÙ… ÚˆØ³Ù¾Ù„Û’ Ø¯ÛŒÚ©Ú¾ÛŒÚº Ú¯Û’Û” Ù…ÙˆØ¬ÙˆØ¯Û ÙˆÙ‚Øª (Ù…Ù„ÛŒ Ø³ÛŒÚ©Ù†Úˆ Ù…ÛŒÚº) ÙˆÛŒÚˆÛŒÙˆ Ú©Û’ Ù†ÛŒÚ†Û’ Ø¯Ú©Ú¾Ø§ÛŒØ§ Ú¯ÛŒØ§ ÛÛ’Û”</p>
          </div>
          
          <div class="tutorial-step">
            <h5>Ù…Ø±Ø­Ù„Û 3: Ø§ÛŒÚ©Ø³Ù¹Ø±ÛŒÚ©Ø´Ù† Ø¢Ù¾Ø´Ù†Ø² Ø³ÛŒÙ¹ Ú©Ø±ÛŒÚº</h5>
            <p>Ø¨ÛŒÚ† ÙØ±ÛŒÙ… Ø§ÛŒÚ©Ø³Ù¹Ø±ÛŒÚ©Ø´Ù† (Ù…Ø®ØµÙˆØµ ÙˆÙ‚ÙÙˆÚº Ù¾Ø± Ù…ØªØ¹Ø¯Ø¯ ÙØ±ÛŒÙ… Ù†Ú©Ø§Ù„Ù†Û’ Ú©Û’ Ù„ÛŒÛ’) ÛŒØ§ Ø³Ù†Ú¯Ù„ ÙØ±ÛŒÙ… Ø§ÛŒÚ©Ø³Ù¹Ø±ÛŒÚ©Ø´Ù† (Ù…Ø®ØµÙˆØµ Ù„Ù…Ø­Ø§Øª Ú©Ùˆ Ù‚ÛŒØ¯ Ú©Ø±Ù†Û’ Ú©Û’ Ù„ÛŒÛ’) Ú©Û’ Ø¯Ø±Ù…ÛŒØ§Ù† Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ø±ÛŒÚºÛ” Ø§Ù¾Ù†Ø§ ØªØ±Ø¬ÛŒØ­ÛŒ Ø¢Ø¤Ù¹ Ù¾Ù¹ ÙØ§Ø±Ù…ÛŒÙ¹ (PNGØŒ JPGØŒ ÛŒØ§ WebP) Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚºÛ”</p>
          </div>
          
          <div class="tutorial-step">
            <h5>Ù…Ø±Ø­Ù„Û 4: ÙØ±ÛŒÙ… Ù†Ú©Ø§Ù„ÛŒÚº</h5>
            <p>Ø§ÛŒÚ©Ø³Ù¹Ø±ÛŒÚ©Ø´Ù† Ú©Ø§ Ø¹Ù…Ù„ Ø´Ø±ÙˆØ¹ Ú©Ø±Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ "ÙØ±ÛŒÙ… Ù†Ú©Ø§Ù„ÛŒÚº" Ø¨Ù¹Ù† Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Ø±ÛŒÚºÛ” Ø³Ù†Ú¯Ù„ ÙØ±ÛŒÙ… Ú©Û’ Ù„ÛŒÛ’ØŒ Ø¢Ù¾ Ù¾Ù„Û’ Ø¨ÛŒÚ© Ú©Ù†Ù¹Ø±ÙˆÙ„Ø² Ú©Ø§ Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Ø±ØªÛ’ ÛÙˆØ¦Û’ ÙˆÛŒÚˆÛŒÙˆ Ú©Û’ Ø°Ø±ÛŒØ¹Û’ Ù†ÛŒÙˆÛŒÚ¯ÛŒÙ¹ Ú©Ø± Ø³Ú©ØªÛ’ ÛÛŒÚº Ø§ÙˆØ± Ú©Ø³ÛŒ Ø¨Ú¾ÛŒ Ù„Ù…Ø­Û’ Ù¾Ø± ÙØ±ÛŒÙ… Ù†Ú©Ø§Ù„ Ø³Ú©ØªÛ’ ÛÛŒÚºÛ”</p>
          </div>
          
          <div class="tutorial-step">
            <h5>Ù…Ø±Ø­Ù„Û 5: ÙØ±ÛŒÙ… ÚˆØ§Ø¤Ù† Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº</h5>
            <p>Ø§ÛŒÚ©Ø³Ù¹Ø±ÛŒÚ©Ø´Ù† Ú©Û’ Ø¨Ø¹Ø¯ØŒ Ø¢Ù¾ Ú©Û’ ÙØ±ÛŒÙ… Ú¯ÛŒÙ„Ø±ÛŒ Ù…ÛŒÚº Ø¸Ø§ÛØ± ÛÙˆÚº Ú¯Û’Û” Ø¢Ù¾ ÙØ±Ø§ÛÙ… Ú©Ø±Ø¯Û ÚˆØ§Ø¤Ù† Ù„ÙˆÚˆ Ø¢Ù¾Ø´Ù†Ø² Ú©Ø§ Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Ø±ØªÛ’ ÛÙˆØ¦Û’ Ø§Ù†ÙØ±Ø§Ø¯ÛŒ ÙØ±ÛŒÙ… ÛŒØ§ Ø§ÛŒÚ© ÛÛŒ ÙˆÙ‚Øª Ù…ÛŒÚº ØªÙ…Ø§Ù… ÙØ±ÛŒÙ… ÚˆØ§Ø¤Ù† Ù„ÙˆÚˆ Ú©Ø± Ø³Ú©ØªÛ’ ÛÛŒÚºÛ”</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Related Tools Section -->
  <section class="section related-tools">
    <div class="container">
      <h2 class="section-title">Ù…ØªØ¹Ù„Ù‚Û Ù¹ÙˆÙ„Ø²</h2>
      <div class="tools-grid" id="relatedTools">
        <!-- Related tools will be dynamically generated by JS -->
      </div>
    </div>
  </section>
</main>

<!-- Footer will be dynamically loaded by JS -->
<div id="footer-container"></div>

<script>
const video = document.getElementById('video');
const canvas = document.createElement('canvas');
const ctx = canvas.getContext('2d');
const framesBox = document.getElementById('frames');
const realTimePreview = document.getElementById('realTimePreview');
const extractedFramesSection = document.getElementById('extractedFramesSection');
const currentTimeElement = document.getElementById('currentTime');
let realTimeFrameCanvas = null;
let realTimeFrameCtx = null;
let animationId = null;

document.getElementById('fileInput').onchange = e => {
  video.src = URL.createObjectURL(e.target.files[0]);
  document.getElementById('uploadBox').classList.add('hidden');
  document.getElementById('videoBox').classList.remove('hidden');
  document.getElementById('toolBox').classList.remove('hidden');
  
  // Show video preview and real-time preview containers
  document.getElementById('videoPreviewContainer').style.display = 'block';
  document.getElementById('realTimePreviewContainer').style.display = 'block';
  
  // Initialize real-time frame display
  initRealTimeFrame();
};

// Update video playback time to milliseconds
video.addEventListener('timeupdate', () => {
  const time = video.currentTime;
  const hours = Math.floor(time / 3600);
  const minutes = Math.floor((time % 3600) / 60);
  const seconds = Math.floor(time % 60);
  const milliseconds = Math.floor((time % 1) * 1000);
  
  currentTimeElement.textContent = 
    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}.${milliseconds.toString().padStart(3, '0')}`;
});

// Initialize real-time frame display
function initRealTimeFrame() {
  // Remove old real-time frame canvas
  if (realTimeFrameCanvas) {
    realTimeFrameCanvas.remove();
  }
  
  // Create new real-time frame canvas
  realTimeFrameCanvas = document.createElement('canvas');
  realTimeFrameCtx = realTimeFrameCanvas.getContext('2d');
  realTimeFrameCanvas.style.width = '100%';
  realTimeFrameCanvas.style.height = '100%';
  realTimeFrameCanvas.style.display = 'block';
  realTimeFrameCanvas.style.borderRadius = '4px'; // Add rounded corner style, consistent with the video on the left
  realTimeFrameCanvas.style.overflow = 'hidden';
  
  // Add to real-time preview area
  realTimePreview.innerHTML = '';
  realTimePreview.appendChild(realTimeFrameCanvas);
  
  // Start real-time capture
  startRealTimeCapture();
}

// Update canvas size to ensure it matches video size exactly
function updateCanvasSize() {
  if (realTimeFrameCanvas) {
    // Ensure Canvas's actual pixel size matches the video exactly
    realTimeFrameCanvas.width = video.videoWidth;
    realTimeFrameCanvas.height = video.videoHeight;
    
    // Get the actual display size of the video element on the left (excluding padding and border)
    const videoElement = document.getElementById('video');
    const videoRect = videoElement.getBoundingClientRect();
    
    // Directly set the display size of the real-time frame Canvas to be the same as the video on the left
    // Do not consider container padding, ensure the image size is consistent
    realTimeFrameCanvas.style.width = `${videoRect.width}px`;
    realTimeFrameCanvas.style.height = `${videoRect.height}px`;
    realTimeFrameCanvas.style.display = 'block';
    realTimeFrameCanvas.style.margin = '0 auto';
    
    // Ensure the width of the right-side preview container is the same as the left 
    const leftContainer = videoElement.closest('.preview-container');
    const rightContainer = realTimePreview.closest('.preview-container');
    if (leftContainer && rightContainer) {
      const leftWidth = leftContainer.getBoundingClientRect().width;
      rightContainer.style.width = `${leftWidth}px`;
    }
  }
  
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;
}

// Add window size change and video size change listeners
window.addEventListener('resize', updateCanvasSize);
video.addEventListener('loadedmetadata', updateCanvasSize);
video.addEventListener('loadeddata', updateCanvasSize);
video.addEventListener('resize', updateCanvasSize);

// Start real-time capture
function startRealTimeCapture() {
  if (animationId) return;
  
  function captureFrame() {
    if (realTimeFrameCtx) {
      realTimeFrameCtx.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);
    }
    animationId = requestAnimationFrame(captureFrame);
  }
  
  captureFrame();
}

// Listen for video time changes, ensure real-time preview updates
video.addEventListener('timeupdate', () => {
  if (realTimeFrameCtx) {
    realTimeFrameCtx.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);
  }
});

// Listen for video seek complete event
video.addEventListener('seeked', () => {
  if (realTimeFrameCtx) {
    realTimeFrameCtx.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);
  }
});

// Listen for window size changes, update real-time frame size
window.addEventListener('resize', updateCanvasSize);

// Stop real-time capture
function stopRealTimeCapture() {
  if (animationId) {
    cancelAnimationFrame(animationId);
    animationId = null;
  }
}

// Listen for video play and pause events
video.addEventListener('play', startRealTimeCapture);
video.addEventListener('pause', stopRealTimeCapture);
video.addEventListener('ended', stopRealTimeCapture);

function parseTime(t){
  if(!t) return 0;
  if(t.includes(':')){
    const p=t.split(':').map(Number);
    return p.length===3?p[0]*3600+p[1]*60+p[2]:p[0]*60+p[1];
  }
  return parseFloat(t);
}

function step(v){
  video.currentTime=Math.max(0,video.currentTime+v);
  // Ensure the right-side real-time preview updates immediately
  if (realTimeFrameCtx) {
    realTimeFrameCtx.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);
  }
}

// Toggle play and pause state
function togglePlayPause() {
  const playPauseBtn = document.getElementById('playPauseBtn');
  if (video.paused || video.ended) {
    video.play();
    playPauseBtn.textContent = 'â¸';
  } else {
    video.pause();
    playPauseBtn.textContent = 'â–¶';
  }
}

// Listen for video play state changes, update button text
video.addEventListener('play', () => {
  const playPauseBtn = document.getElementById('playPauseBtn');
  if (playPauseBtn) {
    playPauseBtn.textContent = 'â¸';
  }
});

video.addEventListener('pause', () => {
  const playPauseBtn = document.getElementById('playPauseBtn');
  if (playPauseBtn) {
    playPauseBtn.textContent = 'â–¶';
  }
});

video.addEventListener('ended', () => {
  const playPauseBtn = document.getElementById('playPauseBtn');
  if (playPauseBtn) {
    playPauseBtn.textContent = 'â–¶';
  }
});

// Delete video and return to upload module
function deleteVideo() {
  // Stop video playback
  video.pause();
  video.src = '';
  
  // Clear real-time frame
  if (realTimeFrameCanvas) {
    realTimeFrameCanvas.remove();
    realTimeFrameCanvas = null;
    realTimeFrameCtx = null;
  }
  
  // Clear extracted frames
  framesBox.innerHTML = '';
  extractedFramesSection.style.display = 'none';
  
  // Reset time display
  currentTimeElement.textContent = '00:00:00.000';
  
  // Hide video preview and real-time preview containers
  document.getElementById('videoPreviewContainer').style.display = 'none';
  document.getElementById('realTimePreviewContainer').style.display = 'none';
  
  // Hide tool area, show upload area
  document.getElementById('toolBox').classList.add('hidden');
  document.getElementById('videoBox').classList.add('hidden');
  document.getElementById('uploadBox').classList.remove('hidden');
  
  // Reset fileInput's value to solve the issue of not being able to upload the same video again
  document.getElementById('fileInput').value = '';
  
  // Stop real-time capture
  stopRealTimeCapture();
  
  // Reset play button state
  const playPauseBtn = document.getElementById('playPauseBtn');
  if (playPauseBtn) {
    playPauseBtn.textContent = 'â–¶';
  }
}

// Clear all extracted frames
function clearFrames() {
  // Clear all extracted frames
  framesBox.innerHTML = '';
  // Hide the extracted frames area
  extractedFramesSection.style.display = 'none';
}

// Download all extracted frames individually
function downloadAllIndividually() {
  const images = framesBox.querySelectorAll('img');
  if (images.length === 0) {
    alert('No frames to download!');
    return;
  }
  
  const formatInput = document.getElementById('format');
  const format = formatInput.value;
  const extension = format === 'image/png' ? 'png' : format === 'image/jpeg' ? 'jpg' : 'webp';
  
  images.forEach((img, index) => {
    const a = document.createElement('a');
    a.href = img.src;
    a.download = `frame_${index + 1}.${extension}`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  });
}

// Download single frame
function downloadFrame(imgElement) {
  const a = document.createElement('a');
  a.href = imgElement.src;
  
  const formatInput = document.getElementById('format');
  const format = formatInput.value;
  const extension = format === 'image/png' ? 'png' : format === 'image/jpeg' ? 'jpg' : 'webp';
  
  a.download = `frame_${Date.now()}.${extension}`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}

// Delete single frame
function deleteFrame(imgElement) {
  imgElement.closest('.frame-item').remove();
  
  // If there are no remaining frames, hide the extracted frames area
  if (framesBox.querySelectorAll('.frame-item').length === 0) {
    extractedFramesSection.style.display = 'none';
  }
}

// ZIP download functionality (Note: requires JSZip library, basic implementation provided)
function downloadAllAsZip() {
  const images = framesBox.querySelectorAll('img');
  if (images.length === 0) {
    alert('No frames to download!');
    return;
  }
  
  alert('ZIP download functionality requires JSZip library. Please download frames individually for now.');
  // In actual projects, JSZip library can be used here to create and download ZIP files
}

function capture(time, format='image/png'){
  return new Promise(res=>{
    video.currentTime=time;
    video.onseeked=()=>{
      canvas.width=video.videoWidth;
      canvas.height=video.videoHeight;
      ctx.drawImage(video,0,0);
      res(canvas.toDataURL(format));
    };
  });
}

async function extract(){
  const startTimeInput = document.getElementById('startTime');
  const endTimeInput = document.getElementById('endTime');
  const frameCountInput = document.getElementById('frameCount');
  const formatInput = document.getElementById('format');
  
  const start=parseTime(startTimeInput.value);
  const end=parseTime(endTimeInput.value);
  const count=parseInt(frameCountInput.value);
  const format=formatInput.value;

  let times=[];
  if(start && end && count){
    const step=(end-start)/(count-1);
    for(let i=0;i<count;i++) times.push(start+i*step);
  } else {
    // If no batch settings, use current video time
    times=[video.currentTime];
  }

  for(const t of times){
    const url=await capture(t, format);
    
    // Create frame container with delete and download icons
    const frameItem = document.createElement('div');
    frameItem.className = 'frame-item';
    frameItem.style = 'position: relative; display: inline-block; margin: 5px;';
    
    // Create screenshot image
    const img=document.createElement('img');
    img.src=url;
    img.style = 'width: 100%; display: block; border-radius: 4px;';
    
    // Create icon container
    const iconsContainer = document.createElement('div');
    iconsContainer.style = 'position: absolute; top: 5px; right: 5px; display: flex; gap: 5px;';
    
    // Create delete icon
    const deleteIcon = document.createElement('button');
    deleteIcon.innerHTML = '<i class="fas fa-trash"></i>';
    deleteIcon.style = 'background: #ef4444; color: white; border: none; border-radius: 4px; padding: 4px; font-size: 12px; cursor: pointer; z-index: 10;';
    deleteIcon.onclick = () => deleteFrame(img);
    
    // Create download icon
    const downloadIcon = document.createElement('button');
    downloadIcon.innerHTML = '<i class="fas fa-download"></i>';
    downloadIcon.style = 'background: #3b82f6; color: white; border: none; border-radius: 4px; padding: 4px; font-size: 12px; cursor: pointer; z-index: 10;';
    downloadIcon.onclick = () => downloadFrame(img);
    
    // Assemble elements
    iconsContainer.appendChild(deleteIcon);
    iconsContainer.appendChild(downloadIcon);
    frameItem.appendChild(img);
    frameItem.appendChild(iconsContainer);
    
    framesBox.appendChild(frameItem);
  }
  
  // If there are extracted frames, show the extracted frames area
  if (framesBox.children.length > 0) {
    extractedFramesSection.style.display = 'block';
  }
}
</script>

    <!-- Include the main script file for language switcher and other functionality -->
    <script src="../../scripts/script.js"></script>

<!-- Include the related tools script -->
<script src="../../scripts/script-related-tools.js"></script>

<!-- Initialize related tools with current tool slug -->
<script>
    // Call the related tools function with the current tool's slug
    initRelatedTools("video-frame-extractor");
</script>

</body>
</html>
