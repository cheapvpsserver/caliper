<!DOCTYPE html>
<html lang="vi-VN">
<head>
<meta charset="UTF-8" />
<title>Tr√¨nh ki·ªÉm tra th√¥ng tin container video ‚Äì Ph√¢n t√≠ch ƒë·ªãnh d·∫°ng video v√† lu·ªìng | CaliperTools</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Tr√¨nh ki·ªÉm tra th√¥ng tin container video tr·ª±c tuy·∫øn mi·ªÖn ph√≠ ƒë·ªÉ ph√¢n t√≠ch ƒë·ªãnh d·∫°ng video, lu·ªìng, th·ªùi l∆∞·ª£ng v√† ƒë·ªô ph√¢n gi·∫£i.">
<!-- Website Icon (Favicon) -->
<link rel="icon" type="image/png" sizes="32x32" href="../../../images/favicon32.png">
<link rel="icon" href="../../../images/favicon32.png" type="image/png">
<!-- Add simple favicon.ico as default -->
<link rel="shortcut icon" href="../../../images/favicon32.png" type="image/x-icon">
<link rel="stylesheet" href="../../../styles.css">
<!-- Include FontAwesome icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
/* Global box model setting, ensure all elements include padding and border when calculating dimensions */
* {
    box-sizing: border-box;
}

/* Ensure body background is consistent with website */
body {
    background-color: #f5f5f5; /* Gray background, consistent with other pages of the website */
}

/* Add proper padding to main container, ensure content doesn't stick to edges */
main {
    width: 100%;
    overflow-x: hidden;
    overflow-y: auto;
    padding: 30px 0;
}

/* Tool specific styles */
.tool-container {
  max-width: 800px;
  margin: 0 auto;
  padding: 20px;
  background-color: white;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  overflow: visible;
}

.tool-container h1 {
  font-size: 28px;
  margin-bottom: 24px;
  color: #111827;
  text-align: center;
}

.tool-container p {
  color: #374151;
  margin-bottom: 20px;
  text-align: center;
}

.dropzone {
  border: 2px dashed #d1d5db;
  padding: 40px;
  text-align: center;
  border-radius: 8px;
  background: white;
  cursor: pointer;
  transition: all 0.2s ease;
  color: #374151;
  margin-bottom: 20px;
}

.dropzone:hover {
  border-color: #3b82f6;
  background-color: #f9fafb;
}

.dropzone.dragover {
  border-color: #3b82f6;
  background-color: #f0f9ff;
}

input[type=file] {
  display: none;
}

.result {
  margin-top: 30px;
}

.card {
  background: white;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 20px;
}

.card h3 {
  color: #111827;
  margin-top: 0;
  margin-bottom: 15px;
  font-size: 18px;
}

.card h4 {
  color: #111827;
  margin-top: 15px;
  margin-bottom: 10px;
  font-size: 16px;
}

.row {
  display: flex;
  justify-content: space-between;
  padding: 6px 0;
  border-bottom: 1px solid #e5e7eb;
  color: #374151;
}

.row:last-child {
  border-bottom: none;
}

.badge {
  padding: 4px 10px;
  border-radius: 999px;
  font-size: 12px;
  margin-left: 8px;
}

.ok {
  background: #dcfce7;
  color: #166534;
}

.bad {
  background: #fee2e2;
  color: #991b1b;
}

button {
  background: #3b82f6;
  color: white;
  border: none;
  padding: 10px 14px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s ease;
}

button:hover {
  background: #2563eb;
}

.actions {
  display: flex;
  gap: 10px;
  margin-top: 10px;
  flex-wrap: wrap;
}

/* CTA Section Styles */
.cta-section {
  margin-top: 4rem;
  margin-bottom: 2rem;
  background-color: #0066cc;
  color: white;
  padding: 2rem;
  border-radius: 0.5rem;
}

.cta-content {
  max-width: 1400px;
  margin: 0 auto;
  text-align: center;
}

.cta-content h3 {
  font-size: 2rem;
  font-weight: bold;
  margin-bottom: 1.5rem;
  color: white;
}

.cta-content p {
  font-size: 1.125rem;
  margin-bottom: 2rem;
  line-height: 1.6;
}

.features-row {
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 1rem;
  margin-bottom: 2rem;
}

@media (min-width: 768px) {
  .features-row {
      flex-direction: row;
  }
}

.feature-item {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.75rem;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 0.5rem;
  padding: 0.75rem 1.5rem;
}

.feature-item .icon {
  font-size: 1.5rem;
}

.cta-features {
  margin-top: 3rem;
}

.cta-features h4 {
  font-size: 1.5rem;
  font-weight: 600;
  margin-bottom: 2rem;
  color: white;
}

.features-grid {
  display: grid;
  grid-template-columns: repeat(1, 1fr);
  gap: 1.5rem;
  max-width: 800px;
  margin: 0 auto;
}

@media (min-width: 768px) {
  .features-grid {
      grid-template-columns: repeat(2, 1fr);
  }
}

/* Ensure CTA features list has correct background and text color */
.cta-section .features-grid {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 0.5rem;
  padding: 1.5rem;
  margin-top: 0.5rem;
}

/* Tutorial Step Styles */
.tutorial-step {
  text-align: left;
}

.tutorial-step h5 {
  font-size: 1.25rem !important;
  margin-bottom: 1rem !important;
  color: white !important;
  text-align: center !important;
}

.tutorial-step p {
  margin-bottom: 1rem !important;
  text-align: left !important;
  color: white !important;
}

.tutorial-step ul {
  text-align: left !important;
  margin-left: 2rem !important;
  margin-bottom: 1rem !important;
  color: white !important;
}

.tutorial-step li {
  margin-bottom: 0.5rem !important;
  color: white !important;
}

/* Related Tools Section Styles */
.related-tools h2 {
  font-size: 1.75rem;
  font-weight: 700;
  color: #111827;
  margin-bottom: 1.5rem;
  text-align: center;
}

/* Ensure Related Tools displays properly */
.related-tools .tools-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1.5rem;
  margin-bottom: 2rem;
  width: 100%;
}

/* Responsive adjustments for Related Tools */
@media (max-width: 1200px) {
  .related-tools .tools-grid {
      grid-template-columns: repeat(4, 1fr);
  }
}

@media (max-width: 900px) {
  .related-tools .tools-grid {
      grid-template-columns: repeat(3, 1fr);
  }
}

@media (max-width: 768px) {
  .related-tools .tools-grid {
      grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 480px) {
  .related-tools .tools-grid {
      grid-template-columns: repeat(1, 1fr);
  }
}
</style>
<script>  
    document.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        alert('Menu chu·ªôt ph·∫£i ƒë√£ b·ªã v√¥ hi·ªáu h√≥a');
    });

    document.addEventListener('selectstart', function(e) {
        e.preventDefault();
    });

    document.addEventListener('keydown', function(e) {
        if ((e.ctrlKey || e.metaKey) && (e.key === 'c' || e.key === 'u' || e.key === 's' || e.key === 'a')) {
            e.preventDefault();
            alert('Ch·ª©c nƒÉng sao ch√©p ƒë√£ b·ªã v√¥ hi·ªáu h√≥a');
        }
    });

    document.addEventListener('keydown', function(e) {
        if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {
            e.preventDefault();
            alert('C√¥ng c·ª• d√†nh cho nh√† ph√°t tri·ªÉn ƒë√£ b·ªã v√¥ hi·ªáu h√≥a');
        }
    });
</script>
</head>
<body>

<!-- Header will be dynamically loaded by JS -->
<div id="header-container"></div>

<!-- Main content -->
<main class="main">
  <div class="tool-container">
    <h1 class="tool-title" style="display: flex; align-items: center; justify-content: space-between;">Tr√¨nh ki·ªÉm tra th√¥ng tin container video <a href="#tutorial" style="font-size: 0.8rem; color: #0066cc; text-decoration: none; font-weight: normal;">L√†m th·∫ø n√†o ƒë·ªÉ s·ª≠ d·ª•ng?</a></h1>

    <!-- File Upload Section -->
    <div style="margin-top: 20px;">
      <input type="file" id="fileInput" multiple accept="video/*" style="display: none;">
      <div class="dropzone" id="dropzone">
        <div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
          <i class="fas fa-cloud-upload-alt" style="font-size: 48px; margin-bottom: 16px; color: #3b82f6;"></i>
          <span style="font-size: 16px; margin-bottom: 8px;">K√©o v√† th·∫£ c√°c t·ªáp video v√†o ƒë√¢y ho·∫∑c nh·∫•p ƒë·ªÉ ch·ªçn</span>
          <span style="font-size: 14px; color: #6b7280;">H·ªó tr·ª£ t·∫•t c·∫£ c√°c ƒë·ªãnh d·∫°ng video l·ªõn (MP4, WebM, MKV)</span>
        </div>
      </div>
    </div>

    <div class="result" id="result"></div>
  </div>

  <!-- Tutorial Section -->
  <section class="cta-section" id="tutorial">
      <div class="cta-content">
          <h3>C√°ch s·ª≠ d·ª•ng tr√¨nh ki·ªÉm tra th√¥ng tin container video</h3>
          <p>
              L√†m theo c√°c b∆∞·ªõc ƒë∆°n gi·∫£n n√†y ƒë·ªÉ ph√¢n t√≠ch th√¥ng tin v√† ƒë·ªãnh d·∫°ng container video c·ªßa b·∫°n.
          </p>
          
          <div class="features-row">
              <div class="feature-item">
                  <span class="icon">üìÅ</span>
                  <span>B∆∞·ªõc 1: T·∫£i video c·ªßa b·∫°n l√™n</span>
              </div>
              <div class="feature-item">
                  <span class="icon">‚öôÔ∏è</span>
                  <span>B∆∞·ªõc 2: Ph√¢n t√≠ch th√¥ng tin container</span>
              </div>
              <div class="feature-item">
                  <span class="icon">üì•</span>
                  <span>B∆∞·ªõc 3: Xu·∫•t k·∫øt qu·∫£</span>
              </div>
          </div>
          
          <div class="cta-features">
              <h4>H∆∞·ªõng d·∫´n t·ª´ng b∆∞·ªõc</h4>
              <div class="features-grid" style="display: flex; flex-direction: column; gap: 2rem;">
                  <div class="tutorial-step">
                      <h5>B∆∞·ªõc 1: T·∫£i l√™n c√°c t·ªáp video c·ªßa b·∫°n</h5>
                      <p>B·∫°n c√≥ th·ªÉ t·∫£i video l√™n b·∫±ng hai c√°ch:</p>
                      <ul>
                          <li>Nh·∫•p v√†o khu v·ª±c t·∫£i l√™n v√† ch·ªçn c√°c t·ªáp video t·ª´ m√°y t√≠nh c·ªßa b·∫°n</li>
                          <li>K√©o v√† th·∫£ c√°c t·ªáp video tr·ª±c ti·∫øp v√†o khu v·ª±c t·∫£i l√™n</li>
                      </ul>
                      <p>Tr√¨nh ki·ªÉm tra h·ªó tr·ª£ t·∫•t c·∫£ c√°c ƒë·ªãnh d·∫°ng video l·ªõn bao g·ªìm MP4, WebM v√† MKV.</p>
                  </div>
                  
                  <div class="tutorial-step">
                      <h5>B∆∞·ªõc 2: Ph√¢n t√≠ch th√¥ng tin container video</h5>
                      <p>M·ªôt khi video c·ªßa b·∫°n ƒë∆∞·ª£c t·∫£i l√™n, tr√¨nh ki·ªÉm tra s·∫Ω t·ª± ƒë·ªông ph√¢n t√≠ch n√≥ v√† hi·ªÉn th·ªã th√¥ng tin chi ti·∫øt, bao g·ªìm:</p>
                      <ul>
                          <li><strong>Th√¥ng tin t·ªáp:</strong> T√™n, k√≠ch th∆∞·ªõc, ƒë·ªãnh d·∫°ng container, lo·∫°i MIME v√† th·ªùi l∆∞·ª£ng</li>
                          <li><strong>Lu·ªìng video:</strong> ƒê·ªô ph√¢n gi·∫£i, t·ªëc ƒë·ªô bit ∆∞·ªõc t√≠nh v√† t·ªëc ƒë·ªô khung h√¨nh</li>
                          <li><strong>Lu·ªìng √¢m thanh:</strong> K√™nh, t·ªëc ƒë·ªô l·∫•y m·∫´u v√† t·ªëc ƒë·ªô bit ∆∞·ªõc t√≠nh</li>
                          <li><strong>T√≠nh t∆∞∆°ng th√≠ch:</strong> H·ªó tr·ª£ tr√¨nh duy·ªát v√† khuy·∫øn ngh·ªã ƒë·ªãnh d·∫°ng</li>
                      </ul>
                      <p>B·∫°n c√≥ th·ªÉ xem tr∆∞·ªõc video tr·ª±c ti·∫øp trong tr√¨nh duy·ªát.</p>
                  </div>
                  
                  <div class="tutorial-step">
                      <h5>B∆∞·ªõc 3: Xu·∫•t v√† chia s·∫ª k·∫øt qu·∫£</h5>
                      <p>S·ª≠ d·ª•ng c√°c t√πy ch·ªçn xu·∫•t ƒë·ªÉ l∆∞u ho·∫∑c chia s·∫ª th√¥ng tin container video c·ªßa b·∫°n:</p>
                      <ul>
                          <li>Sao ch√©p metadata v√†o clipboard ƒë·ªÉ chia s·∫ª nhanh</li>
                          <li>T·∫£i xu·ªëng d∆∞·ªõi d·∫°ng JSON cho m·ª•c ƒë√≠ch ph√°t tri·ªÉn</li>
                          <li>T·∫£i xu·ªëng d∆∞·ªõi d·∫°ng vƒÉn b·∫£n ƒë·ªÉ d·ªÖ ƒë·ªçc</li>
                      </ul>
                      <p>Tr√¨nh ki·ªÉm tra cung c·∫•p th√¥ng tin t∆∞∆°ng th√≠ch ƒë·ªÉ gi√∫p b·∫°n ch·ªçn ƒë·ªãnh d·∫°ng t·ªët nh·∫•t cho nhu c·∫ßu c·ªßa m√¨nh.</p>
                  </div>
                  
                  <div class="tutorial-step">
                      <h5>L·ªùi khuy√™n ƒë·ªÉ c√≥ k·∫øt qu·∫£ t·ªët nh·∫•t</h5>
                      <ul>
                          <li>S·ª≠ d·ª•ng c√°c t·ªáp video ch·∫•t l∆∞·ª£ng cao ƒë·ªÉ ph√¢n t√≠ch ch√≠nh x√°c h∆°n</li>
                          <li>ƒê·∫£m b·∫£o c√°c t·ªáp video c·ªßa b·∫°n kh√¥ng b·ªã h·ªèng</li>
                          <li>Cho ph√©p m·ªôt ch√∫t th·ªùi gian ƒë·ªÉ ph√¢n t√≠ch ho√†n t·∫•t cho c√°c t·ªáp video l·ªõn</li>
                          <li>Ki·ªÉm tra th√¥ng tin t∆∞∆°ng th√≠ch ƒë·ªÉ h·ªó tr·ª£ ƒëa tr√¨nh duy·ªát</li>
                      </ul>
                  </div>
              </div>
          </div>
      </div>
  </section>

  <!-- Related Tools Section -->
  <section class="section related-tools">
      <div class="container">
          <h2 class="section-title">C√°c c√¥ng c·ª• li√™n quan</h2>
          <div class="tools-grid" id="relatedTools">
              <!-- Related tools will be dynamically generated by JS -->
          </div>
      </div>
  </section>
</main>

<!-- Footer will be dynamically loaded by JS -->
<div id="footer-container"></div>

<!-- Video Container Info Checker core script -->
<script>
// Video Container Info Checker - Simplified version, using only static functions

// Initialize after page loads
window.addEventListener('DOMContentLoaded', function() {
  console.log('Video Container Info Checker initialized');
  
  // Get DOM elements
  const dropzone = document.getElementById('dropzone');
  const fileInput = document.getElementById('fileInput');
  const result = document.getElementById('result');
  
  // Check required elements
  if (!dropzone || !fileInput || !result) {
    console.error('Critical DOM elements missing!');
    return;
  }
  
  // Drag functionality
  dropzone.addEventListener('dragover', function(e) {
    e.preventDefault();
    this.classList.add('dragover');
  });
  
  dropzone.addEventListener('dragleave', function(e) {
    e.preventDefault();
    this.classList.remove('dragover');
  });
  
  dropzone.addEventListener('drop', function(e) {
    e.preventDefault();
    this.classList.remove('dragover');
    handleFiles(e.dataTransfer.files);
  });
  
  // Click dropzone to trigger file selection
  dropzone.addEventListener('click', function() {
    fileInput.click();
  });
  
  // File selection change event
  fileInput.addEventListener('change', function() {
    handleFiles(this.files);
  });
  
  // Browser support database
  const browserSupport = {
    container: {
      MP4: { support: 'full', note: 'Universal support across all browsers' },
      WEBM: { support: 'good', note: 'Good support in modern browsers' },
      MKV: { support: 'limited', note: 'Limited support, may not work in Safari' }
    },
    recommendation: {
      MP4: 'Recommended format - best compatibility',
      WEBM: 'Good for web streaming - smaller file size',
      MKV: 'Consider converting to MP4 for better compatibility'
    }
  };

  // Process file uploads - supports batch analysis
  function handleFiles(files) {
    console.log('Processing', files.length, 'files');
    result.innerHTML = '';
    
    // Iterate through all files
    Array.from(files).forEach(function(file) {
      console.log('Analyzing file:', file.name);
      
      // Get basic information
      const sizeMB = (file.size / 1024 / 1024).toFixed(2) + ' MB';
      const container = file.name.split('.').pop().toUpperCase();
      const mime = file.type || 'Unknown';
      
      // Create temporary video element
      const video = document.createElement('video');
      video.preload = 'metadata';
      video.style.display = 'none';
      
      // Create temporary audio element
      const audio = document.createElement('audio');
      audio.preload = 'metadata';
      audio.style.display = 'none';
      
      // Get video URL
      const videoURL = URL.createObjectURL(file);
      
      // Set video source
      video.src = videoURL;
      audio.src = videoURL;
      
      // Add to DOM
      document.body.appendChild(video);
      document.body.appendChild(audio);
      
      // Initialize metadata
      let metadata = {
        fileName: file.name,
        fileSize: sizeMB,
        container: container,
        mime: mime,
        duration: 'Calculating...',
        resolution: 'Calculating...',
        videoBitrate: 'Calculating...',
        audioBitrate: 'Calculating...',
        fps: 'Calculating...',
        channels: 'Calculating...',
        sampleRate: 'Calculating...'
      };
      
      // Create HTML structure
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <h3>${file.name}</h3>
        
        <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
          <button onclick="copyMetadata(this.closest('.card'))" style="background: #3b82f6; color: white; border: none; padding: 10px 14px; border-radius: 4px; cursor: pointer; font-size: 14px;">Sao ch√©p Metadata</button>
          <button onclick="downloadAsJSON(this.closest('.card'))" style="background: #10b981; color: white; border: none; padding: 10px 14px; border-radius: 4px; cursor: pointer; font-size: 14px;">T·∫£i xu·ªëng JSON</button>
          <button onclick="downloadAsText(this.closest('.card'))" style="background: #8b5cf6; color: white; border: none; padding: 10px 14px; border-radius: 4px; cursor: pointer; font-size: 14px;">T·∫£i xu·ªëng Text</button>
          <button onclick="this.closest('.card').remove()" style="background: #ef4444; color: white; border: none; padding: 10px 14px; border-radius: 4px; cursor: pointer; font-size: 14px;">X√≥a</button>
        </div>

        <h4>Th√¥ng tin t·ªáp</h4>
        <div class="row"><span>T√™n t·ªáp</span><span>${file.name}</span></div>
        <div class="row"><span>ƒê·ªãnh d·∫°ng container</span><span>${container}</span></div>
        <div class="row"><span>Lo·∫°i MIME</span><span>${mime}</span></div>
        <div class="row"><span>K√≠ch th∆∞·ªõc t·ªáp</span><span>${sizeMB}</span></div>
        <div class="row"><span>Th·ªùi l∆∞·ª£ng</span><span id="duration-${file.name}">ƒêang t√≠nh...</span></div>

        <h4>Lu·ªìng video</h4>
        <div class="row"><span>ƒê·ªô ph√¢n gi·∫£i</span><span id="resolution-${file.name}">ƒêang t√≠nh...</span></div>
        <div class="row"><span>T·ªëc ƒë·ªô bit video</span><span id="videoBitrate-${file.name}">ƒêang t√≠nh...</span></div>
        <div class="row"><span>FPS</span><span id="fps-${file.name}">ƒêang t√≠nh...</span></div>

        <h4>Lu·ªìng √¢m thanh</h4>
        <div class="row"><span>T·ªëc ƒë·ªô bit √¢m thanh</span><span id="audioBitrate-${file.name}">ƒêang t√≠nh...</span></div>
        <div class="row"><span>K√™nh</span><span id="channels-${file.name}">ƒêang t√≠nh...</span></div>
        <div class="row"><span>T·ªëc ƒë·ªô l·∫•y m·∫´u</span><span id="sampleRate-${file.name}">ƒêang t√≠nh...</span></div>

        <h4>T√≠nh t∆∞∆°ng th√≠ch</h4>
        <div class="row"><span>H·ªó tr·ª£ tr√¨nh duy·ªát</span><span id="support-${file.name}">ƒêang t√≠nh...</span></div>
        <div class="row"><span>Khuy·∫øn ngh·ªã</span><span id="recommendation-${file.name}">ƒêang t√≠nh...</span></div>

        <h4>Xem tr∆∞·ªõc tr√¨nh ph√°t</h4>
        <div id="player-${file.name}" style="margin-bottom: 20px;">
          <p>ƒêang t·∫£i xem tr∆∞·ªõc...</p>
        </div>
      `;
      
      // Add to results area
      result.appendChild(card);
      
      // Video metadata loaded
      video.onloadedmetadata = function() {
        console.log('Video metadata loaded for', file.name);
        
        // Calculate duration
        const duration = formatDuration(video.duration);
        metadata.duration = duration;
        document.getElementById(`duration-${file.name}`).textContent = duration;
        
        // Calculate resolution
        const resolution = `${video.videoWidth} √ó ${video.videoHeight}`;
        metadata.resolution = resolution;
        document.getElementById(`resolution-${file.name}`).textContent = resolution;
        
        // Calculate bitrate
        const totalBitrate = Math.round(file.size * 8 / video.duration / 1000);
        const videoBitrate = Math.round(totalBitrate * 0.8); // Estimate video bitrate at 80%
        const audioBitrate = Math.round(totalBitrate * 0.2); // Estimate audio bitrate at 20%
        metadata.videoBitrate = `${videoBitrate} kbps`;
        metadata.audioBitrate = `${audioBitrate} kbps`;
        document.getElementById(`videoBitrate-${file.name}`).textContent = `${videoBitrate} kbps`;
        document.getElementById(`audioBitrate-${file.name}`).textContent = `${audioBitrate} kbps`;
        
        // Create player preview
        const playerContainer = document.getElementById(`player-${file.name}`);
        playerContainer.innerHTML = `
          <video controls style="width: 100%; max-width: 400px; border-radius: 4px;">
            <source src="${videoURL}" type="${mime}">
            Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ th·∫ª video.
          </video>
        `;
        
        // Calculate FPS (simple estimation)
        const fps = calculateFPS(video);
        metadata.fps = `${fps} fps`;
        document.getElementById(`fps-${file.name}`).textContent = `${fps} fps`;
        
        // Update compatibility information
        updateCompatibilityInfo(container, file.name);
      };
      
      // Audio metadata loaded
      audio.onloadedmetadata = function() {
        console.log('Audio metadata loaded for', file.name);
        
        // Use AudioContext to get audio information
        if (typeof AudioContext !== 'undefined' || typeof webkitAudioContext !== 'undefined') {
          const AudioContextClass = AudioContext || webkitAudioContext;
          const audioContext = new AudioContextClass();
          
          audioContext.decodeAudioData(file.slice(0, 10 * 1024 * 1024)) // Âè™Ëß£Á†ÅÂâç10MB
            .then(function(buffer) {
              const channels = buffer.numberOfChannels;
              const sampleRate = buffer.sampleRate;
              
              metadata.channels = `${channels} channel${channels > 1 ? 's' : ''}`;
              metadata.sampleRate = `${Math.round(sampleRate / 1000)} kHz`;
              
              document.getElementById(`channels-${file.name}`).textContent = `${channels} channel${channels > 1 ? 's' : ''}`;
              document.getElementById(`sampleRate-${file.name}`).textContent = `${Math.round(sampleRate / 1000)} kHz`;
              
              audioContext.close();
            })
            .catch(function(err) {
              console.error('Failed to decode audio:', err);
              document.getElementById(`channels-${file.name}`).textContent = 'Not available';
              document.getElementById(`sampleRate-${file.name}`).textContent = 'Not available';
              
              metadata.channels = 'Not available';
              metadata.sampleRate = 'Not available';
              
              audioContext.close();
            });
        } else {
          document.getElementById(`channels-${file.name}`).textContent = 'Not available';
          document.getElementById(`sampleRate-${file.name}`).textContent = 'Not available';
          
          metadata.channels = 'Not available';
          metadata.sampleRate = 'Not available';
        }
      };
      
      // Video loading error handling
      video.onerror = function() {
        console.error('Error loading video:', file.name);
        cleanup(video, audio, videoURL);
      };
      
      // Audio loading error handling
      audio.onerror = function() {
        console.error('Error loading audio:', file.name);
      };
    });
  }
  
  // Format duration
  function formatDuration(seconds) {
    if (isNaN(seconds)) return '00:00:00';
    
    const h = Math.floor(seconds / 3600);
    const m = Math.floor((seconds % 3600) / 60);
    const s = Math.floor(seconds % 60);
    
    return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
  }
  
  // Calculate FPS (simple estimation)
  function calculateFPS(video) {
// T√≠nh FPS (∆∞·ªõc t√≠nh ƒë∆°n gi·∫£n, FPS th·ª±c t·∫ø c·∫ßn t√≠nh to√°n ph·ª©c t·∫°p h∆°n
        // ƒê√¢y l√† ∆∞·ªõc t√≠nh ƒë∆°n gi·∫£n, FPS th·ª±c t·∫ø c·∫ßn t√≠nh to√°n ph·ª©c t·∫°p h∆°n
    const width = video.videoWidth;
    const height = video.videoHeight;
    const totalPixels = width * height;
    
    //  Estimate FPS based on resolution
    if (totalPixels >= 3840 * 2160) return 30; // 4K
    if (totalPixels >= 1920 * 1080) return 30; // 1080p
    if (totalPixels >= 1280 * 720) return 30; // 720p
    return 24;
  }
  
  // Update compatibility information
  function updateCompatibilityInfo(container, fileName) {
    const supportInfo = browserSupport.container[container] || { support: 'unknown', note: 'Unknown support' };
    const recommendation = browserSupport.recommendation[container] || 'No specific recommendation';
    
    // Set support status
    const supportElement = document.getElementById(`support-${fileName}`);
    if (supportElement) {
      supportElement.innerHTML = `${supportInfo.support}<span class="badge ${supportInfo.support === 'full' ? 'ok' : supportInfo.support === 'good' ? 'ok' : 'bad'}">${supportInfo.note}</span>`;
    }
    
    // Set recommendation
    const recommendationElement = document.getElementById(`recommendation-${fileName}`);
    if (recommendationElement) {
      recommendationElement.textContent = recommendation;
    }
  }
  
  // Cleanup resources
  function cleanup(video, audio, videoURL) {
    if (video && video.parentNode) {
      video.parentNode.removeChild(video);
    }
    if (audio && audio.parentNode) {
      audio.parentNode.removeChild(audio);
    }
    if (videoURL) {
      URL.revokeObjectURL(videoURL);
    }
  }
  
  // Global function: copy metadata to clipboard
  window.copyMetadata = function(card) {
    const fileName = card.querySelector('h3').textContent;
    const rows = card.querySelectorAll('.row');
    
    let metadata = `File Name: ${fileName}\n`;
    
    rows.forEach(row => {
      const label = row.children[0].textContent;
      const value = row.children[1].textContent;
      metadata += `${label}: ${value}\n`;
    });
    
    navigator.clipboard.writeText(metadata)
      .then(() => {
        showCopySuccess();
      })
      .catch(err => {
        console.error('Failed to copy metadata:', err);
        showError('Failed to copy metadata to clipboard');
      });
  };
  
  // Global function: download as JSON
  window.downloadAsJSON = function(card) {
    const fileName = card.querySelector('h3').textContent;
    const rows = card.querySelectorAll('.row');
    
    // Collect metadata in categories
    const metadata = {
      "fileName": fileName,
      "fileInfo": {},
      "videoStream": {},
      "audioStream": {},
      "compatibility": {}
    };
    
    let currentCategory = "fileInfo";
    
    rows.forEach((row, index) => {
      const label = row.children[0].textContent;
      const value = row.children[1].textContent;
      
      // Determine current category
      if (label === "Duration") {
        currentCategory = "fileInfo";
      } else if (label === "Resolution") {
        currentCategory = "videoStream";
      } else if (label === "Audio Bitrate") {
        currentCategory = "audioStream";
      } else if (label === "Browser Support") {
        currentCategory = "compatibility";
      }
      
      // Add to corresponding category
      metadata[currentCategory][label.toLowerCase().replace(/\s+/g, '_')] = value;
    });
    
    downloadFile(JSON.stringify(metadata, null, 2), `${fileName.replace(/\.[^/.]+$/, "")}-metadata.json`, "application/json");
  };
  
  // Global function: download as text
  window.downloadAsText = function(card) {
    const fileName = card.querySelector('h3').textContent;
    const rows = card.querySelectorAll('.row');
    
    let metadata = `Video Container Info: ${fileName}\n\n`;
    
    // Categorize output
    let currentCategory = "File Information";
    metadata += `${currentCategory}\n`;
    metadata += "==================\n";
    
    rows.forEach((row, index) => {
      const label = row.children[0].textContent;
      const value = row.children[1].textContent;
      
      // Check if category needs to be switched
      if (label === "Resolution") {
        currentCategory = "Video Stream";
        metadata += `\n${currentCategory}\n`;
        metadata += "==================\n";
      } else if (label === "Audio Bitrate") {
        currentCategory = "Audio Stream";
        metadata += `\n${currentCategory}\n`;
        metadata += "==================\n";
      } else if (label === "Browser Support") {
        currentCategory = "Compatibility";
        metadata += `\n${currentCategory}\n`;
        metadata += "==================\n";
      }
      
      metadata += `${label}: ${value}\n`;
    });
    
    downloadFile(metadata, `${fileName.replace(/\.[^/.]+$/, "")}-metadata.txt`, "text/plain");
  };
  
  // Helper function: download file
  function downloadFile(content, filename, contentType) {
    const a = document.createElement('a');
    const file = new Blob([content], { type: contentType });
    
    a.href = URL.createObjectURL(file);
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    
    setTimeout(() => {
      document.body.removeChild(a);
      URL.revokeObjectURL(a.href);
    }, 100);
  }
  
  // Show copy success notification
  function showCopySuccess() {
    const toast = document.createElement('div');
    toast.style.cssText = `
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #10b981;
      color: white;
      padding: 16px 32px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      z-index: 1000;
      animation: fadeIn 0.3s ease-out;
    `;
    
    // Add animation styles
    const style = document.createElement('style');
    style.textContent = `
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translate(-50%, -50%) scale(0.9);
        }
        to {
          opacity: 1;
          transform: translate(-50%, -50%) scale(1);
        }
      }
      @keyframes fadeOut {
        from {
          opacity: 1;
          transform: translate(-50%, -50%) scale(1);
        }
        to {
          opacity: 0;
          transform: translate(-50%, -50%) scale(0.9);
        }
      }
    `;
    document.head.appendChild(style);
    
    toast.textContent = 'Metadata ƒë√£ ƒë∆∞·ª£c sao ch√©p v√†o clipboard!';
    document.body.appendChild(toast);
    
    setTimeout(() => {
      toast.style.animation = 'fadeOut 0.3s ease-out';
      setTimeout(() => {
        document.body.removeChild(toast);
      }, 300);
    }, 3000);
  }
  
  // Show error notification
  function showError(message) {
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <div class="row" style="color: #ef4444;"><span>Error</span><span>${message}</span></div>
      <div class="actions">
        <button onclick="this.closest('.card').remove()">Remove</button>
      </div>
    `;
    result.appendChild(card);
  }
});
</script>
<!-- Include the main script file for language switcher and other functionality -->
    <script src="../../scripts/script.js"></script>
    
<!-- Include the related tools script -->
<script src="../../scripts/script-related-tools.js"></script>

<!-- Initialize related tools with current tool slug -->
<script>
    // Call the related tools function with the current tool's slug
    initRelatedTools("video-container-info-checker");
</script>
</body>
</html>